/*!
 * UEditor Mini\u7248\u672c
 * version: 1.0.0
 * build: Tue Sep 17 2013 15:57:30 GMT+0800 (CST)
 */
(function(){function s(n,t,i){var r;return t=t.toLowerCase(),(r=n.__allListeners||i&&(n.__allListeners={}))&&(r[t]||i&&(r[t]=[]))}var e,l,c,a;UMEDITOR_CONFIG=window.UMEDITOR_CONFIG||{},window.UM={plugins:{},commands:{},I18N:{},version:"1.0.0"};var u=UM.dom={},t=UM.browser=function(){var i=navigator.userAgent.toLowerCase(),u=window.opera,n={ie:!!window.ActiveXObject,opera:!!u&&u.version,webkit:i.indexOf(" applewebkit/")>-1,mac:i.indexOf("macintosh")>-1,quirks:document.compatMode=="BackCompat"},t,r;return n.gecko=navigator.product=="Gecko"&&!n.webkit&&!n.opera,t=0,n.ie&&(t=parseFloat(i.match(/msie (\d+)/)[1]),n.ie9Compat=document.documentMode==9,n.ie8=!!document.documentMode,n.ie8Compat=document.documentMode==8,n.ie7Compat=t==7&&!document.documentMode||document.documentMode==7,n.ie6Compat=t<7||n.quirks,n.ie9above=t>8,n.ie9below=t<9),n.gecko&&(r=i.match(/rv:([\d\.]+)/),r&&(r=r[1].split("."),t=r[0]*1e4+(r[1]||0)*100+(r[2]||0)*1)),/chrome\/(\d+\.\d)/i.test(i)&&(n.chrome=+RegExp.$1),/(\d+\.\d)?(?:\.\d)?\s+safari\/?(\d+\.\d+)?/i.test(i)&&!/chrome/i.test(i)&&(n.safari=+(RegExp.$1||RegExp.$2)),n.opera&&(t=parseFloat(u.version())),n.webkit&&(t=parseFloat(i.match(/ applewebkit\/(\d+)/)[1])),n.version=t,n.isCompatible=!n.mobile&&(n.ie&&t>=6||n.gecko&&t>=10801||n.opera&&t>=9.5||n.air&&t>=1||n.webkit&&t>=522||!1),n}(),f=t.ie,w=t.webkit,p=t.gecko,y=t.opera,i=UM.utils={each:function(n,t,i){var r,f,u;if(n==null)return;if(n.length===+n.length){for(r=0,f=n.length;r<f;r++)if(t.call(i,n[r],r,n)===!1)return!1}else for(u in n)if(n.hasOwnProperty(u))if(t.call(i,n[u],u,n)===!1)return!1},makeInstance:function(n){var t=new Function;return t.prototype=n,n=new t,t.prototype=null,n},extend:function(n,t,i){if(t)for(var r in t)(!i||!n.hasOwnProperty(r))&&(n[r]=t[r]);return n},extend2:function(n){for(var u=arguments,r,t,i=1;i<u.length;i++){r=u[i];for(t in r)n.hasOwnProperty(t)||(n[t]=r[t])}return n},inherits:function(n,t){var u=n.prototype,r=i.makeInstance(t.prototype);return i.extend(r,u,!0),n.prototype=r,r.constructor=n},bind:function(n,t){return function(){return n.apply(t,arguments)}},defer:function(n,t,i){var r;return function(){i&&clearTimeout(r),r=setTimeout(n,t)}},indexOf:function(n,t,i){var r=-1;return i=this.isNumber(i)?i:0,this.each(n,function(n,u){if(u>=i&&n===t)return r=u,!1}),r},removeItem:function(n,t){for(var i=0,r=n.length;i<r;i++)n[i]===t&&(n.splice(i,1),i--)},trim:function(n){return n.replace(/(^[ \t\n\r]+)|([ \t\n\r]+$)/g,"")},listToMap:function(n){if(!n)return{};n=i.isArray(n)?n:n.split(",");for(var u=0,t,r={};t=n[u++];)r[t.toUpperCase()]=r[t]=1;return r},unhtml:function(n,t){return n?n.replace(t||/[&<">'](?:(amp|lt|quot|gt|#39|nbsp);)?/g,function(n,t){return t?n:({"<":"&lt;","&":"&amp;",'"':"&quot;",">":"&gt;","'":"&#39;"})[n]}):""},html:function(n){return n?n.replace(/&((g|l|quo)t|amp|#39);/g,function(n){return({"&lt;":"<","&amp;":"&","&quot;":'"',"&gt;":">","&#39;":"'"})[n]}):""},cssStyleToDomStyle:function(){var t=document.createElement("div").style,n={"float":t.cssFloat!=undefined?"cssFloat":t.styleFloat!=undefined?"styleFloat":"float"};return function(t){return n[t]||(n[t]=t.toLowerCase().replace(/-./g,function(n){return n.charAt(1).toUpperCase()}))}}(),loadFile:function(){function n(n,i){try{for(var u=0,r;r=t[u++];)if(r.doc===n&&r.url==(i.src||i.href))return r}catch(f){return null}}var t=[];return function(i,r,u){var e=n(i,r),s,f,o;if(e){e.ready?u&&u():e.funs.push(u);return}t.push({doc:i,url:r.src||r.href,funs:[u]});if(!i.body){s=[];for(o in r){if(o=="tag")continue;s.push(o+'="'+r[o]+'"')}i.write("<"+r.tag+" "+s.join(" ")+" ></"+r.tag+">");return}if(r.id&&i.getElementById(r.id))return;f=i.createElement(r.tag),delete r.tag;for(o in r)f.setAttribute(o,r[o]);f.onload=f.onreadystatechange=function(){if(!this.readyState||/loaded|complete/.test(this.readyState)){e=n(i,r);if(e.funs.length>0){e.ready=1;for(var t;t=e.funs.pop();)t()}f.onload=f.onreadystatechange=null}},f.onerror=function(){throw Error("The load "+(r.href||r.src)+" fails,check the url settings of file umeditor.config.js ");},i.getElementsByTagName("head")[0].appendChild(f)}}(),isEmptyObject:function(n){if(n==null)return!0;if(this.isArray(n)||this.isString(n))return n.length===0;for(var t in n)if(n.hasOwnProperty(t))return!1;return!0},fixColor:function(n,t){var r,u,i;if(/color/i.test(n)&&/rgba?/.test(t)){r=t.split(",");if(r.length>3)return"";for(t="#",u=0;i=r[u++];)i=parseInt(i.replace(/[^\d]/gi,""),10).toString(16),t+=i.length==1?"0"+i:i;t=t.toUpperCase()}return t},clone:function(n,t){var u,r;t=t||{};for(r in n)n.hasOwnProperty(r)&&(u=n[r],typeof u=="object"?(t[r]=i.isArray(u)?[]:{},i.clone(n[r],t[r])):t[r]=u);return t},transUnitToPx:function(n){if(!/(pt|cm)/.test(n))return n;var t;n.replace(/([\d.]+)(\w+)/,function(i,r,u){n=r,t=u});switch(t){case"cm":n=parseFloat(n)*25;break;case"pt":n=Math.round(parseFloat(n)*96/72)}return n+(n?"px":"")},domReady:function(){function n(n){n.isReady=!0;for(var t;t=i.pop();t());}var i=[];return function(r,u){u=u||window;var f=u.document;r&&i.push(r),f.readyState==="complete"?n(f):(f.isReady&&n(f),t.ie?((function(){if(f.isReady)return;try{f.documentElement.doScroll("left")}catch(t){setTimeout(arguments.callee,0);return}n(f)})(),u.attachEvent("onload",function(){n(f)})):(f.addEventListener("DOMContentLoaded",function(){f.removeEventListener("DOMContentLoaded",arguments.callee,!1),n(f)},!1),u.addEventListener("load",function(){n(f)},!1)))}}(),cssRule:t.ie?function(n,t,i){var r,f,u;i=i||document,r=i.indexList?i.indexList:i.indexList={};if(r[n])u=i.styleSheets[r[n]];else{if(t===undefined)return"";u=i.createStyleSheet("",f=i.styleSheets.length),r[n]=f}if(t===undefined)return u.cssText;u.cssText=t||""}:function(n,t,i){i=i||document;var u=i.getElementsByTagName("head")[0],r;if(!(r=i.getElementById(n))){if(t===undefined)return"";r=i.createElement("style"),r.id=n,u.appendChild(r)}if(t===undefined)return r.innerHTML;t!==""?r.innerHTML=t:u.removeChild(r)}};i.each(["String","Function","Array","Number","RegExp","Object"],function(n){UM.utils["is"+n]=function(t){return Object.prototype.toString.apply(t)=="[object "+n+"]"}}),e=UM.EventBase=function(){},e.prototype={addListener:function(n,t){n=i.trim(n).split(" ");for(var u=0,r;r=n[u++];)s(this,r,!0).push(t)},removeListener:function(n,t){n=i.trim(n).split(" ");for(var u=0,r;r=n[u++];)i.removeItem(s(this,r)||[],t)},fireEvent:function(){for(var u=arguments[0],e,t,f,n,r,u=i.trim(u).split(" "),o=0;e=u[o++];){t=s(this,e);if(t){r=t.length;while(r--){if(!t[r])continue;n=t[r].apply(this,arguments);if(n===!0)return n;n!==undefined&&(f=n)}}(n=this["on"+e.toLowerCase()])&&(f=n.apply(this,arguments))}return f}};var r=u.dtd=function(){function n(n){for(var t in n)n[t.toUpperCase()]=n[t];return n}var r=i.extend2,h=n({isindex:1,fieldset:1}),k=n({input:1,button:1,select:1,textarea:1,label:1}),b=r(n({a:1}),k),c=r({iframe:1},b),o=n({hr:1,ul:1,menu:1,div:1,blockquote:1,noscript:1,table:1,center:1,address:1,dir:1,pre:1,h5:1,dl:1,h4:1,noframes:1,h6:1,ol:1,h1:1,h3:1,h2:1}),w=n({ins:1,del:1,script:1,style:1}),d=r(n({b:1,acronym:1,bdo:1,"var":1,"#":1,abbr:1,code:1,br:1,i:1,cite:1,kbd:1,u:1,strike:1,s:1,tt:1,strong:1,q:1,samp:1,em:1,dfn:1,span:1}),w),nt=r(n({sub:1,img:1,embed:1,object:1,sup:1,basefont:1,map:1,applet:1,font:1,big:1,small:1}),d),s=r(n({p:1}),nt),tt=r(n({iframe:1}),nt,k),g=n({img:1,embed:1,noscript:1,br:1,kbd:1,center:1,button:1,basefont:1,h5:1,h4:1,samp:1,h6:1,ol:1,h1:1,h3:1,h2:1,form:1,font:1,"#":1,select:1,menu:1,ins:1,abbr:1,label:1,code:1,table:1,script:1,cite:1,input:1,iframe:1,strong:1,textarea:1,noframes:1,big:1,small:1,span:1,hr:1,sub:1,bdo:1,"var":1,div:1,object:1,sup:1,strike:1,dir:1,map:1,dl:1,applet:1,del:1,isindex:1,fieldset:1,ul:1,b:1,acronym:1,a:1,blockquote:1,i:1,u:1,s:1,tt:1,address:1,q:1,pre:1,p:1,em:1,dfn:1}),t=r(n({a:0}),tt),l=n({tr:1}),f=n({"#":1}),p=r(n({param:1}),g),u=r(n({form:1}),h,c,o,s),e=n({li:1,ol:1,ul:1}),ft=n({style:1,script:1}),a=n({base:1,link:1,meta:1,title:1}),ut=r(a,ft),y=n({head:1,body:1}),rt=n({html:1}),v=n({address:1,blockquote:1,center:1,dir:1,div:1,dl:1,fieldset:1,form:1,h1:1,h2:1,h3:1,h4:1,h5:1,h6:1,hr:1,isindex:1,menu:1,noframes:1,ol:1,p:1,pre:1,table:1,ul:1}),it=n({area:1,base:1,basefont:1,br:1,col:1,command:1,dialog:1,embed:1,hr:1,img:1,input:1,isindex:1,keygen:1,link:1,meta:1,param:1,source:1,track:1,wbr:1});return n({$nonBodyContent:r(rt,y,a),$block:v,$inline:t,$inlineWithA:r(n({a:1}),t),$body:r(n({script:1,style:1}),v),$cdata:n({script:1,style:1}),$empty:it,$nonChild:n({iframe:1,textarea:1}),$listItem:n({dd:1,dt:1,li:1}),$list:n({ul:1,ol:1,dl:1}),$isNotEmpty:n({table:1,ul:1,ol:1,dl:1,iframe:1,area:1,base:1,col:1,hr:1,img:1,embed:1,input:1,link:1,meta:1,param:1,h1:1,h2:1,h3:1,h4:1,h5:1,h6:1}),$removeEmpty:n({a:1,abbr:1,acronym:1,address:1,b:1,bdo:1,big:1,cite:1,code:1,del:1,dfn:1,em:1,font:1,i:1,ins:1,label:1,kbd:1,q:1,s:1,samp:1,small:1,span:1,strike:1,strong:1,sub:1,sup:1,tt:1,u:1,"var":1}),$removeEmptyBlock:n({p:1,div:1}),$tableContent:n({caption:1,col:1,colgroup:1,tbody:1,td:1,tfoot:1,th:1,thead:1,tr:1,table:1}),$notTransContent:n({pre:1,script:1,style:1,textarea:1}),html:y,head:ut,style:f,script:f,body:u,base:{},link:{},meta:{},title:f,col:{},tr:n({td:1,th:1}),img:{},embed:{},colgroup:n({thead:1,col:1,tbody:1,tr:1,tfoot:1}),noscript:u,td:u,br:{},th:u,center:u,kbd:t,button:r(s,o),basefont:{},h5:t,h4:t,samp:t,h6:t,ol:e,h1:t,h3:t,option:f,h2:t,form:r(h,c,o,s),select:n({optgroup:1,option:1}),font:t,ins:t,menu:e,abbr:t,label:t,table:n({thead:1,col:1,tbody:1,tr:1,colgroup:1,caption:1,tfoot:1}),code:t,tfoot:l,cite:t,li:u,input:{},iframe:u,strong:t,textarea:f,noframes:u,big:t,small:t,span:n({"#":1,br:1,b:1,strong:1,u:1,i:1,em:1,sub:1,sup:1,strike:1,span:1}),hr:t,dt:t,sub:t,optgroup:n({option:1}),param:{},bdo:t,"var":t,div:u,object:p,sup:t,dd:u,strike:t,area:{},dir:e,map:r(n({area:1,form:1,p:1}),h,w,o),applet:p,dl:n({dt:1,dd:1}),del:t,isindex:{},fieldset:r(n({legend:1}),g),thead:l,ul:e,acronym:t,b:t,a:r(n({a:1}),tt),blockquote:r(n({td:1,tr:1,tbody:1,li:1}),u),caption:t,i:t,u:t,tbody:l,s:t,address:r(c,s),tt:t,legend:t,q:t,pre:r(d,b),p:r(n({a:1}),t),em:t,dfn:t})}(),h=f&&t.version<9?{tabindex:"tabIndex",readonly:"readOnly","for":"htmlFor","class":"className",maxlength:"maxLength",cellspacing:"cellSpacing",cellpadding:"cellPadding",rowspan:"rowSpan",colspan:"colSpan",usemap:"useMap",frameborder:"frameBorder"}:{tabindex:"tabIndex",readonly:"readOnly"},v=i.listToMap(["-webkit-box","-moz-box","block","list-item","table","table-row-group","table-header-group","table-footer-group","table-row","table-column-group","table-column","table-cell","table-caption"]),n=u.domUtils={NODE_ELEMENT:1,NODE_DOCUMENT:9,NODE_TEXT:3,NODE_COMMENT:8,NODE_DOCUMENT_FRAGMENT:11,POSITION_IDENTICAL:0,POSITION_DISCONNECTED:1,POSITION_FOLLOWING:2,POSITION_PRECEDING:4,POSITION_IS_CONTAINED:8,POSITION_CONTAINS:16,fillChar:f&&t.version=="6"?"\ufeff":"\u200b",keys:{8:1,46:1,16:1,17:1,18:1,37:1,38:1,39:1,40:1,13:1},breakParent:function(t,i){var r,f=t,o=t,u,e;do{f=f.parentNode,u?(r=f.cloneNode(!1),r.appendChild(u),u=r,r=f.cloneNode(!1),r.appendChild(e),e=r):(u=f.cloneNode(!1),e=u.cloneNode(!1));while(r=o.previousSibling)u.insertBefore(r,u.firstChild);while(r=o.nextSibling)e.appendChild(r);o=f}while(i!==f);return r=i.parentNode,r.insertBefore(u,i),r.insertBefore(e,i),r.insertBefore(t,e),n.remove(i),t},trimWhiteTextNode:function(t){function i(i){var r;while((r=t[i])&&r.nodeType==3&&n.isWhitespace(r))t.removeChild(r)}i("firstChild"),i("lastChild")},getPosition:function(n,t){var i,f,u,r;if(n===t)return 0;f=[n],u=[t],i=n;while(i=i.parentNode){if(i===t)return 10;f.push(i)}i=t;while(i=i.parentNode){if(i===n)return 20;u.push(i)}f.reverse(),u.reverse();if(f[0]!==u[0])return 1;r=-1;while(r++,f[r]===u[r]);n=f[r],t=u[r];while(n=n.nextSibling)if(n===t)return 4;return 2},getNodeIndex:function(n,t){var i=n,r=0;while(i=i.previousSibling){if(t&&i.nodeType==3){i.nodeType!=i.nextSibling.nodeType&&r++;continue}r++}return r},inDoc:function(t,i){return n.getPosition(t,i)==10},findParent:function(t,i,r){if(t&&!n.isBody(t)){t=r?t:t.parentNode;while(t){if(!i||i(t)||n.isBody(t))return i&&!i(t)&&n.isBody(t)?null:t;t=t.parentNode}}return null},findParentByTagName:function(t,r,u,f){return r=i.listToMap(i.isArray(r)?r:[r]),n.findParent(t,function(n){return r[n.tagName]&&!(f&&f(n))},u)},findParents:function(t,i,r,u){var f=i&&(r&&r(t)||!r)?[t]:[];while(t=n.findParent(t,r))f.push(t);return u?f:f.reverse()},insertAfter:function(n,t){return n.parentNode.insertBefore(t,n.nextSibling)},remove:function(n,t){var i=n.parentNode,r;if(i){if(t&&n.hasChildNodes())while(r=n.firstChild)i.insertBefore(r,n);i.removeChild(n)}return n},isBookmarkNode:function(n){return n.nodeType==1&&n.id&&/^_baidu_bookmark_/i.test(n.id)},getWindow:function(n){var t=n.ownerDocument||n;return t.defaultView||t.parentWindow},split:function(i,r){var e=i.ownerDocument,o,u,f;return t.ie&&r==i.nodeValue.length?(o=e.createTextNode(""),n.insertAfter(i,o)):(u=i.splitText(r),t.ie8&&(f=e.createTextNode(""),n.insertAfter(u,f),n.remove(f)),u)},isWhitespace:function(t){return!new RegExp("[^ \x09\x0a\x0d"+n.fillChar+"]").test(t.nodeValue)},getXY:function(n){var i=0,t=0;while(n.offsetParent)t+=n.offsetTop,i+=n.offsetLeft,n=n.offsetParent;return{x:i,y:t}},on:function(n,t,r){var o=i.isArray(t)?t:[t],f=o.length,u,e;if(f)while(f--)t=o[f],n.addEventListener?n.addEventListener(t,r,!1):(r._d||(r._d={els:[]}),u=t+r.toString(),e=i.indexOf(r._d.els,n),(!r._d[u]||e==-1)&&(e==-1&&r._d.els.push(n),r._d[u]||(r._d[u]=function(n){return r.call(n.srcElement,n||window.event)}),n.attachEvent("on"+t,r._d[u])));n=null},un:function(n,t,r){var o=i.isArray(t)?t:[t],e=o.length,u,f;if(e)while(e--){t=o[e];if(n.removeEventListener)n.removeEventListener(t,r,!1);else{u=t+r.toString();try{n.detachEvent("on"+t,r._d?r._d[u]:r)}catch(s){}r._d&&r._d[u]&&(f=i.indexOf(r._d.els,n),f!=-1&&r._d.els.splice(f,1),r._d.els.length==0&&delete r._d[u])}}},isEmptyInlineElement:function(t){if(t.nodeType!=1||!r.$removeEmpty[t.tagName])return 0;t=t.firstChild;while(t){if(n.isBookmarkNode(t))return 0;if(t.nodeType==1&&!n.isEmptyInlineElement(t)||t.nodeType==3&&!n.isWhitespace(t))return 0;t=t.nextSibling}return 1},isBlockElm:function(t){return t.nodeType==1&&(r.$block[t.tagName]||v[n.getComputedStyle(t,"display")])&&!r.$nonChild[t.tagName]},getElementsByTagName:function(n,t,r){var o,f,h,c,s,e,u;for(r&&i.isString(r)&&(o=r,r=function(n){var t=!1;return jQuery.each(i.trim(o).replace(/[ ]{2,}/g," ").split(" "),function(i,r){if(jQuery(n).hasClass(r))return t=!0,!1}),t}),t=i.trim(t).replace(/[ ]{2,}/g," ").split(" "),f=[],h=0;c=t[h++];)for(s=n.getElementsByTagName(c),e=0;u=s[e++];)(!r||r(u))&&f.push(u);return f},unSelectable:f||t.opera?function(n){n.onselectstart=function(){return!1},n.onclick=n.onkeyup=n.onkeydown=function(){return!1},n.unselectable="on",n.setAttribute("unselectable","on");for(var i=0,t;t=n.all[i++];)switch(t.tagName.toLowerCase()){case"iframe":case"textarea":case"input":case"select":break;default:t.unselectable="on",n.setAttribute("unselectable","on")}}:function(n){n.style.MozUserSelect=n.style.webkitUserSelect=n.style.KhtmlUserSelect="none"},removeAttributes:function(n,r){r=i.isArray(r)?r:i.trim(r).replace(/[ ]{2,}/g," ").split(" ");for(var f=0,u;u=r[f++];){u=h[u]||u;switch(u){case"className":n[u]="";break;case"style":n.style.cssText="",!t.ie&&n.removeAttributeNode(n.getAttributeNode("style"))}n.removeAttribute(u)}},createElement:function(t,i,r){return n.setAttributes(t.createElement(i),r)},setAttributes:function(n,t){var i,r;for(i in t)if(t.hasOwnProperty(i)){r=t[i];switch(i){case"class":n.className=r;break;case"style":n.style.cssText=n.style.cssText+";"+r;break;case"innerHTML":n[i]=r;break;case"value":n.value=r;break;default:n.setAttribute(h[i]||i,r)}}return n},getComputedStyle:function(n,t){return i.transUnitToPx(i.fixColor(t,jQuery(n).css(t)))},preventDefault:function(n){n.preventDefault?n.preventDefault():n.returnValue=!1},getStyle:function(n,t){var r=n.style[i.cssStyleToDomStyle(t)];return i.fixColor(t,r)},setStyle:function(n,t,r){n.style[i.cssStyleToDomStyle(t)]=r,i.trim(n.style.cssText)||this.removeAttributes(n,"style")},removeDirtyAttr:function(n){for(var r=0,t,i=n.getElementsByTagName("*");t=i[r++];)t.removeAttribute("_moz_dirty");n.removeAttribute("_moz_dirty")},getChildCount:function(n,t){var r=0,i=n.firstChild;t=t||function(){return 1};while(i)t(i)&&r++,i=i.nextSibling;return r},isEmptyNode:function(t){return!t.firstChild||n.getChildCount(t,function(t){return!n.isBr(t)&&!n.isBookmarkNode(t)&&!n.isWhitespace(t)})==0},isBr:function(n){return n.nodeType==1&&n.tagName=="BR"},isFillChar:function(t,i){return t.nodeType==3&&!t.nodeValue.replace(new RegExp((i?"^":"")+n.fillChar),"").length},isEmptyBlock:function(i,u){if(i.nodeType!=1)return 0;u=u||new RegExp("[ \x09\x0d\x0a"+n.fillChar+"]","g");if(i[t.ie?"innerText":"textContent"].replace(u,"").length>0)return 0;for(var f in r.$isNotEmpty)if(i.getElementsByTagName(f).length)return 0;return 1},isCustomeNode:function(n){return n.nodeType==1&&n.getAttribute("_ue_custom_node_")},fillNode:function(i,r){var u=t.ie?i.createTextNode(n.fillChar):i.createElement("br");r.innerHTML="",r.appendChild(u)},isBoundaryNode:function(t,i){var r;while(!n.isBody(t)){r=t,t=t.parentNode;if(r!==t[i])return!1}return!0},isFillChar:function(t,i){return t.nodeType==3&&!t.nodeValue.replace(new RegExp((i?"^":"")+n.fillChar),"").length}},o=new RegExp(n.fillChar,"g");(function(){function v(n){n.collapsed=n.startContainer&&n.endContainer&&n.startContainer===n.endContainer&&n.startOffset==n.endOffset}function y(n){return!n.collapsed&&n.startContainer.nodeType==1&&n.startContainer===n.endContainer&&n.endOffset-n.startOffset==1}function h(t,i,u,f){return i.nodeType==1&&(r.$empty[i.tagName]||r.$nonChild[i.tagName])&&(u=n.getNodeIndex(i)+(t?0:1),i=i.parentNode),t?(f.startContainer=i,f.startOffset=u,f.endContainer||f.collapse(!0)):(f.endContainer=i,f.endOffset=u,f.startContainer||f.collapse(!1)),v(f),f}function l(r,u){try{if(i&&n.inDoc(i,r))if(i.nodeValue.replace(o,"").length)i.nodeValue=i.nodeValue.replace(o,"");else{var f=i.parentNode;n.remove(i);while(f&&n.isEmptyInlineElement(f)&&(t.safari?!(n.getPosition(f,u)&n.POSITION_CONTAINS):!f.contains(u)))i=f.parentNode,n.remove(f),f=i}}catch(e){}}function f(t,i){var r;t=t[i];while(t&&n.isFillChar(t))r=t[i],n.remove(t),t=r}function a(t,i){var r=t.startContainer,o=t.endContainer,h=t.startOffset,w=t.endOffset,v=t.document,b=v.createDocumentFragment(),d,k,u,l,s,y;r.nodeType==1&&(r=r.childNodes[h]||(d=r.appendChild(v.createTextNode("")))),o.nodeType==1&&(o=o.childNodes[w]||(k=o.appendChild(v.createTextNode(""))));if(r===o&&r.nodeType==3)return b.appendChild(v.createTextNode(r.substringData(h,w-h))),i&&(r.deleteData(h,w-h),t.collapse(!0)),b;var f,p,e=b,c=n.findParents(r,!0),a=n.findParents(o,!0);for(u=0;c[u]==a[u];)u++;for(s=u;l=c[s];s++){f=l.nextSibling,l==r?d||(t.startContainer.nodeType==3?(e.appendChild(v.createTextNode(r.nodeValue.slice(h))),i&&r.deleteData(h,r.nodeValue.length-h)):e.appendChild(i?r:r.cloneNode(!0))):(p=l.cloneNode(!1),e.appendChild(p));while(f){if(f===o||f===a[s])break;l=f.nextSibling,e.appendChild(i?f:f.cloneNode(!0)),f=l}e=p}for(e=b,c[u]||(e.appendChild(c[u-1].cloneNode(!1)),e=e.firstChild),s=u;y=a[s];s++){f=y.previousSibling,y==o?!k&&t.endContainer.nodeType==3&&(e.appendChild(v.createTextNode(o.substringData(0,w))),i&&o.deleteData(0,w)):(p=y.cloneNode(!1),e.appendChild(p));if(s!=u||!c[u])while(f){if(f===r)break;y=f.previousSibling,e.insertBefore(i?f:f.cloneNode(!0),e.firstChild),f=y}e=p}return i&&t.setStartBefore(a[u]?c[u]?a[u]:c[u-1]:a[u-1]).collapse(!0),d&&n.remove(d),k&&n.remove(k),b}var c=0,e=n.fillChar,i,s=u.Range=function(n,t){var i=this;i.startContainer=i.startOffset=i.endContainer=i.endOffset=null,i.document=n,i.collapsed=!0,i.body=t};s.prototype={deleteContents:function(){var i;return this.collapsed||a(this,1),t.webkit&&(i=this.startContainer,i.nodeType==3&&!i.nodeValue.length&&(this.setStartBefore(i).collapse(!0),n.remove(i))),this},inFillChar:function(){var t=this.startContainer;return this.collapsed&&t.nodeType==3&&t.nodeValue.replace(new RegExp("^"+n.fillChar),"").length+1==t.nodeValue.length?!0:!1},setStart:function(n,t){return h(!0,n,t,this)},setEnd:function(n,t){return h(!1,n,t,this)},setStartAfter:function(t){return this.setStart(t.parentNode,n.getNodeIndex(t)+1)},setStartBefore:function(t){return this.setStart(t.parentNode,n.getNodeIndex(t))},setEndAfter:function(t){return this.setEnd(t.parentNode,n.getNodeIndex(t)+1)},setEndBefore:function(t){return this.setEnd(t.parentNode,n.getNodeIndex(t))},setStartAtFirst:function(n){return this.setStart(n,0)},setStartAtLast:function(n){return this.setStart(n,n.nodeType==3?n.nodeValue.length:n.childNodes.length)},setEndAtFirst:function(n){return this.setEnd(n,0)},setEndAtLast:function(n){return this.setEnd(n,n.nodeType==3?n.nodeValue.length:n.childNodes.length)},selectNode:function(n){return this.setStartBefore(n).setEndAfter(n)},selectNodeContents:function(n){return this.setStart(n,0).setEndAtLast(n)},cloneRange:function(){var n=this;return new s(n.document).setStart(n.startContainer,n.startOffset).setEnd(n.endContainer,n.endOffset)},collapse:function(n){var t=this;return n?(t.endContainer=t.startContainer,t.endOffset=t.startOffset):(t.startContainer=t.endContainer,t.startOffset=t.endOffset),t.collapsed=!0,t},shrinkBoundary:function(t){function f(t){return t.nodeType==1&&!n.isBookmarkNode(t)&&!r.$empty[t.tagName]&&!r.$nonChild[t.tagName]}var i=this,u,e=i.collapsed;while(i.startContainer.nodeType==1&&(u=i.startContainer.childNodes[i.startOffset])&&f(u))i.setStart(u,0);if(e)return i.collapse(!0);if(!t)while(i.endContainer.nodeType==1&&i.endOffset>0&&(u=i.endContainer.childNodes[i.endOffset-1])&&f(u))i.setEnd(u,u.childNodes.length);return i},trimBoundary:function(t){var f;this.txtToElmBoundary();var u=this.startContainer,r=this.startOffset,e=this.collapsed,i=this.endContainer;if(u.nodeType==3){r==0?this.setStartBefore(u):r>=u.nodeValue.length?this.setStartAfter(u):(f=n.split(u,r),u===i?this.setEnd(f,this.endOffset-r):u.parentNode===i&&(this.endOffset+=1),this.setStartBefore(f));if(e)return this.collapse(!0)}return t||(r=this.endOffset,i=this.endContainer,i.nodeType==3&&(r==0?this.setEndBefore(i):(r<i.nodeValue.length&&n.split(i,r),this.setEndAfter(i)))),this},txtToElmBoundary:function(n){function t(n,t){var i=n[t+"Container"],r=n[t+"Offset"];i.nodeType==3&&(r?r>=i.nodeValue.length&&n["set"+t.replace(/(\w)/,function(n){return n.toUpperCase()})+"After"](i):n["set"+t.replace(/(\w)/,function(n){return n.toUpperCase()})+"Before"](i))}return(n||!this.collapsed)&&(t(this,"start"),t(this,"end")),this},insertNode:function(n){var i=n,u=1;n.nodeType==11&&(i=n.firstChild,u=n.childNodes.length),this.trimBoundary(!0);var t=this.startContainer,f=this.startOffset,r=t.childNodes[f];return r?t.insertBefore(n,r):t.appendChild(n),i.parentNode===this.endContainer&&(this.endOffset=this.endOffset+u),this.setStartBefore(i)},setCursor:function(n,t){return this.collapse(!n).select(t)},createBookmark:function(n,t){var r,i=this.document.createElement("span");return i.style.cssText="display:none;line-height:0px;",i.appendChild(this.document.createTextNode("\u200d")),i.id="_baidu_bookmark_start_"+(t?"":c++),this.collapsed||(r=i.cloneNode(!0),r.id="_baidu_bookmark_end_"+(t?"":c++)),this.insertNode(i),r&&this.collapse().insertNode(r).setEndBefore(r),this.setStartAfter(i),{start:n?i.id:i,end:r?n?r.id:r:null,id:n}},moveToBookmark:function(t){var r=t.id?this.document.getElementById(t.start):t.start,i=t.end&&t.id?this.document.getElementById(t.end):t.end;return this.setStartBefore(r),n.remove(r),i?(this.setEndBefore(i),n.remove(i)):this.collapse(!0),this},adjustmentBoundary:function(){if(!this.collapsed){while(!n.isBody(this.startContainer)&&this.startOffset==this.startContainer[this.startContainer.nodeType==3?"nodeValue":"childNodes"].length&&this.startContainer[this.startContainer.nodeType==3?"nodeValue":"childNodes"].length)this.setStartAfter(this.startContainer);while(!n.isBody(this.endContainer)&&!this.endOffset&&this.endContainer[this.endContainer.nodeType==3?"nodeValue":"childNodes"].length)this.setEndBefore(this.endContainer)}return this},getClosedNode:function(){var i,t,n;return this.collapsed||(t=this.cloneRange().adjustmentBoundary().shrinkBoundary(),y(t)&&(n=t.startContainer.childNodes[t.startOffset],n&&n.nodeType==1&&(r.$empty[n.tagName]||r.$nonChild[n.tagName])&&(i=n))),i},select:t.ie?function(t,r){var u,v,c,o,y,a,h,s;this.collapsed||this.shrinkBoundary(),v=this.getClosedNode();if(v&&!r){try{u=this.document.body.createControlRange(),u.addElement(v),u.select()}catch(p){}return this}c=this.createBookmark(),o=c.start,u=this.document.body.createTextRange(),u.moveToElementText(o),u.moveStart("character",1),this.collapsed?!t&&this.startContainer.nodeType!=3&&(h=this.document.createTextNode(e),s=this.document.createElement("span"),s.appendChild(this.document.createTextNode(e)),o.parentNode.insertBefore(s,o),o.parentNode.insertBefore(h,o),l(this.document,h),i=h,f(s,"previousSibling"),f(o,"nextSibling"),u.moveStart("character",-1),u.collapse(!0)):(a=this.document.body.createTextRange(),y=c.end,a.moveToElementText(y),u.setEndPoint("EndToEnd",a)),this.moveToBookmark(c),s&&n.remove(s);try{u.select()}catch(p){}return this}:function(r){function v(n){function t(t,i,r){t.nodeType==3&&t.nodeValue.length<i&&(n[r+"Offset"]=t.nodeValue.length)}t(n.startContainer,n.startOffset,"start"),t(n.endContainer,n.endOffset,"end")}var a=n.getWindow(this.document),c=a.getSelection(),o,s,h,u;t.gecko?this.body.focus():a.focus();if(c){c.removeAllRanges(),this.collapsed&&!r&&(s=this.startContainer,u=s,s.nodeType==1&&(u=s.childNodes[this.startOffset]),!(s.nodeType==3&&this.startOffset)&&(u?!u.previousSibling||u.previousSibling.nodeType!=3:!s.lastChild||s.lastChild.nodeType!=3)&&(o=this.document.createTextNode(e),this.insertNode(o),l(this.document,o),f(o,"previousSibling"),f(o,"nextSibling"),i=o,this.setStart(o,t.webkit?1:0).collapse(!0))),h=this.document.createRange();if(this.collapsed&&t.opera&&this.startContainer.nodeType==1){u=this.startContainer.childNodes[this.startOffset];if(u){while(u&&n.isBlockElm(u))if(u.nodeType==1&&u.childNodes[0])u=u.childNodes[0];else break;u&&this.setStartBefore(u).collapse(!0)}else u=this.startContainer.lastChild,u&&n.isBr(u)&&this.setStartBefore(u).collapse(!0)}v(this),h.setStart(this.startContainer,this.startOffset),h.setEnd(this.endContainer,this.endOffset),c.addRange(h)}return this},createAddress:function(t,i){function f(t){for(var f=t?r.startContainer:r.endContainer,a=n.findParents(f,!0,function(t){return!n.isBody(t)}),h=[],c,e,s,u,l=0;c=a[l++];)h.push(n.getNodeIndex(c,i));e=0;if(i)if(f.nodeType==3){s=f.previousSibling;while(s&&s.nodeType==3)e+=s.nodeValue.replace(o,"").length,s=s.previousSibling;e+=t?r.startOffset:r.endOffset}else{f=f.childNodes[t?r.startOffset:r.endOffset];if(f)e=n.getNodeIndex(f,i);else{f=t?r.startContainer:r.endContainer,u=f.firstChild;while(u){if(n.isFillChar(u)){u=u.nextSibling;continue}e++;if(u.nodeType==3)while(u&&u.nodeType==3)u=u.nextSibling;else u=u.nextSibling}}}else e=t?n.isFillChar(f)?0:r.startOffset:r.endOffset;return e<0&&(e=0),h.push(e),h}var u={},r=this;return u.startAddress=f(!0),t||(u.endAddress=r.collapsed?[].concat(u.startAddress):f()),u},moveToAddress:function(n,t){function r(n,t){for(var r=i.body,e,o,f,u=0,s=n.length;u<s;u++){f=n[u],e=r,r=r.childNodes[f];if(!r){o=f;break}}t?r?i.setStartBefore(r):i.setStart(e,o):r?i.setEndBefore(r):i.setEnd(e,o)}var i=this;return r(n.startAddress,!0),!t&&n.endAddress&&r(n.endAddress),i},equals:function(n){for(var t in this)if(this.hasOwnProperty(t))if(this[t]!==n[t])return!1;return!0},scrollIntoView:function(){var t=jQuery('<span style="padding:0;margin:0;display:block;border:0">&nbsp;</span>');this.cloneRange().insertNode(t.get(0));var r=jQuery(window).scrollTop(),i=jQuery(window).height(),n=t.offset().top;(n<r-i||n>r+i)&&(n>r+i?window.scrollTo(0,n-i+t.height()):window.scrollTo(0,r-n)),t.remove()}}})(),(function(){function f(t,i){var a=n.getNodeIndex,e,o,l,p;t=t.duplicate(),t.collapse(i),e=t.parentElement();if(!e.hasChildNodes())return{container:e,offset:0};var h=e.children,u,s=t.duplicate(),v=0,y=h.length-1,c=-1,f;while(v<=y){c=Math.floor((v+y)/2),u=h[c],s.moveToElementText(u),o=s.compareEndPoints("StartToStart",t);if(o>0)y=c-1;else if(o<0)v=c+1;else return{container:e,offset:a(u)}}if(c==-1){s.moveToElementText(e),s.setEndPoint("StartToStart",t),f=s.text.replace(/(\r\n|\r)/g,"\n").length,h=e.childNodes;if(!f)return u=h[h.length-1],{container:u,offset:u.nodeValue.length};l=h.length;while(f>0)f-=h[--l].nodeValue.length;return{container:h[l],offset:-f}}s.collapse(o>0),s.setEndPoint(o>0?"StartToStart":"EndToStart",t),f=s.text.replace(/(\r\n|\r)/g,"\n").length;if(!f)return r.$empty[u.tagName]||r.$nonChild[u.tagName]?{container:e,offset:a(u)+(o>0?0:1)}:{container:u,offset:o>0?0:u.childNodes.length};while(f>0)try{p=u,u=u[o>0?"previousSibling":"nextSibling"],f-=u.nodeValue.length}catch(w){return{container:e,offset:a(p)}}return{container:u,offset:o>0?-f:u.nodeValue.length+f}}function o(n,t){if(n.item)t.selectNode(n.item(0));else{var i=f(n,!0);t.setStart(i.container,i.offset),n.compareEndPoints("StartToEnd",n)!=0&&(i=f(n,!1),t.setEnd(i.container,i.offset))}return t}function i(n,t){var i,r;try{i=n.getNative(t).createRange()}catch(u){return null}return r=i.item?i.item(0):i.parentElement(),(r.ownerDocument||r)===n.document?i:null}var e=u.Selection=function(r,u){var f=this;f.document=r,f.body=u;if(t.ie9below){n.on(u,"beforedeactivate",function(){f._bakIERange=f.getIERange()});n.on(u,"activate",function(){try{var n=i(f);(!n||!f.rangeInBody(n))&&f._bakIERange&&f._bakIERange.select()}catch(t){}f._bakIERange=null})}};e.prototype={hasNativeRange:function(){var r,n;if(!t.ie||t.ie9above){n=this.getNative();if(!n.rangeCount)return!1;r=n.getRangeAt(0)}else r=i(this);return this.rangeInBody(r)},getNative:function(i){var r=this.document;try{return r?t.ie9below||i?r.selection:n.getWindow(r).getSelection():null}catch(u){return null}},getIERange:function(n){var t=i(this,n);if(!t||!this.rangeInBody(t,n))if(this._bakIERange)return this._bakIERange;return t},rangeInBody:function(i,r){var u=t.ie9below||r?i.item?i.item():i.parentElement():i.startContainer;return u===this.body||n.inDoc(u,this.body)},cache:function(){this.clear(),this._cachedRange=this.getRange(),this._cachedStartElement=this.getStart(),this._cachedStartElementPath=this.getStartElementPath()},getStartElementPath:function(){if(this._cachedStartElementPath)return this._cachedStartElementPath;var t=this.getStart();return t?n.findParents(t,!0,null,!0):[]},clear:function(){this._cachedStartElementPath=this._cachedRange=this._cachedStartElement=null},isFocus:function(){return this.hasNativeRange()},getRange:function(){function s(n){var t=r.body.firstChild,i=n.collapsed;while(t&&t.firstChild)n.setStart(t,0),t=t.firstChild;n.startContainer||n.setStart(r.body,0),i&&n.collapse(!0)}var r=this,i,e,f,c,h;if(r._cachedRange!=null)return this._cachedRange;i=new u.Range(r.document,r.body);if(t.ie9below){e=r.getIERange();if(e&&this.rangeInBody(e))try{o(e,i)}catch(l){s(i)}else s(i)}else{f=r.getNative();if(f&&f.rangeCount&&r.rangeInBody(f.getRangeAt(0)))c=f.getRangeAt(0),h=f.getRangeAt(f.rangeCount-1),i.setStart(c.startContainer,c.startOffset).setEnd(h.endContainer,h.endOffset),i.collapsed&&n.isBody(i.startContainer)&&!i.startOffset&&s(i);else{if(this._bakRange&&(this._bakRange.startContainer===this.body||n.inDoc(this._bakRange.startContainer,this.body)))return this._bakRange;s(i)}}return this._bakRange=i},getStart:function(){if(this._cachedStartElement)return this._cachedStartElement;var i=t.ie9below?this.getIERange():this.getRange(),r,n,u,f;if(t.ie9below){if(!i)return this.document.body.firstChild;if(i.item)return i.item(0);r=i.duplicate(),r.text.length>0&&r.moveStart("character",1),r.collapse(1),n=r.parentElement(),f=u=i.parentElement();while(u=u.parentNode)if(u==n){n=f;break}}else{n=i.startContainer,n.nodeType==1&&n.hasChildNodes()&&(n=n.childNodes[Math.min(n.childNodes.length-1,i.startOffset)]);if(n.nodeType==3)return n.parentNode}return n},getText:function(){var i,n;return this.isFocus()&&(i=this.getNative())?(n=t.ie9below?i.createRange():i.getRangeAt(0),t.ie9below?n.text:n.toString()):""}}})(),(function(){function o(t,r){var u,o,f,e;if(r.textarea)if(i.isString(r.textarea)){for(o=0,e=n.getElementsByTagName(t,"textarea");f=e[o++];)if(f.id=="umeditor_textarea_"+r.options.textarea){u=f;break}}else u=r.textarea;u||(t.appendChild(u=n.createElement(document,"textarea",{name:r.options.textarea,id:"umeditor_textarea_"+r.options.textarea,style:"display:none"})),r.textarea=u),u.value=r.hasContents()?r.options.allHtmlEnabled?r.getAllHtml():r.getContent(null,null,!0):""}function s(n){for(var t in UM.plugins)UM.plugins[t].call(n);n.langIsReady=!0,n.fireEvent("langReady")}function a(n){for(var t in n)return t}var l=0,c,h=UM.Editor=function(n){var t=this;t.uid=l++,e.call(t),t.commands={},t.options=i.extend(i.clone(n||{}),UMEDITOR_CONFIG,!0),t.shortcutkeys={},t.inputRules=[],t.outputRules=[],t.setOpt({isShow:!0,initialContent:"",initialStyle:"",autoClearinitialContent:!1,textarea:"editorValue",focus:!1,focusInEnd:!0,autoClearEmptyNode:!0,fullscreen:!1,readonly:!1,zIndex:999,enterTag:"p",lang:"zh-cn",langPath:t.options.UMEDITOR_HOME_URL+"lang/",theme:"default",themePath:t.options.UMEDITOR_HOME_URL+"themes/",allHtmlEnabled:!1,autoSyncData:!0,autoHeightEnabled:!0}),i.isEmptyObject(UM.I18N)?i.loadFile(document,{src:t.options.langPath+t.options.lang+"/"+t.options.lang+".js",tag:"script",type:"text/javascript",defer:"defer"},function(){s(t)}):(t.options.lang=a(UM.I18N),s(t))};h.prototype={ready:function(n){var t=this;n&&(t.isReady?n.apply(t):t.addListener("ready",n))},setOpt:function(n,t){var r={};i.isString(n)?r[n]=t:r=n,i.extend(this.options,r,!0)},getOpt:function(n){return this.options[n]||""},destroy:function(){var i=this,r,t,u;i.fireEvent("destroy"),r=i.container.parentNode,r===document.body&&(r=i.container),t=i.textarea,t?t.style.display="":(t=document.createElement("textarea"),r.parentNode.insertBefore(t,r)),t.style.width=i.body.offsetWidth+"px",t.style.height=i.body.offsetHeight+"px",t.value=i.getContent(),t.id=i.key,r.contains(t)&&jQuery(t).insertBefore(r),r.innerHTML="",n.remove(r),UM.clearCache(i.id);for(u in i)i.hasOwnProperty(u)&&delete this[u]},initialCont:function(n){if(n){n.getAttribute("name")&&(this.options.textarea=n.getAttribute("name"));if(n&&/script|textarea/ig.test(n.tagName)){var t=document.createElement("div");n.parentNode.insertBefore(t,n),this.options.initialContent=UM.htmlparser(n.value||n.innerHTML||this.options.initialContent).toHtml(),n.className&&(t.className=n.className),n.style.cssText&&(t.style.cssText=n.style.cssText),/textarea/i.test(n.tagName)?(this.textarea=n,this.textarea.style.display="none"):(n.parentNode.removeChild(n),n.id&&(t.id=n.id)),n=t,n.innerHTML=""}return n}return null},render:function(n){var e=this,r=e.options,f=function(t){return parseInt(jQuery(n).css(t))},u;i.isString(n)&&(n=document.getElementById(n)),n&&(this.id=n.getAttribute("id"),UM.setEditor(this),i.cssRule("umeditor_body_css",e.options.initialStyle,document),n=this.initialCont(n),n.className+=" edui-body-container",r.minFrameWidth=r.initialFrameWidth?r.initialFrameWidth:r.initialFrameWidth=jQuery(n).width()||UM.defaultWidth,r.initialFrameHeight?r.minFrameHeight=r.initialFrameHeight:r.initialFrameHeight=r.minFrameHeight=jQuery(n).height()||UM.defaultHeight,n.style.width=/%$/.test(r.initialFrameWidth)?"auto":r.initialFrameWidth-f("padding-left")-f("padding-right")+"px",u=/%$/.test(r.initialFrameHeight)?"100%":r.initialFrameHeight-f("padding-top")-f("padding-bottom"),this.options.autoHeightEnabled?(n.style.minHeight=u+"px",n.style.height="",t.ie&&t.version<=6&&(n.style.height=u,n.style.setExpression("height","this.scrollHeight <= "+u+' ? "'+u+'px" : "auto"'))):jQuery(n).height(u),n.style.zIndex=r.zIndex,this._setup(n))},_setup:function(i){var r=this,e=r.options,h,f,s;for(i.contentEditable=!0,document.body.spellcheck=!1,r.document=document,r.window=document.defaultView||document.parentWindow,r.body=i,r.$body=jQuery(i),n.isBody=function(n){return n===i},r.selection=new u.Selection(document,r.body),t.gecko&&(h=this.selection.getNative())&&h.removeAllRanges(),this._initEvents(),f=i.parentNode;f&&!n.isBody(f);f=f.parentNode)if(f.tagName=="FORM"){r.form=f;if(r.options.autoSyncData)n.on(i,"blur",function(){o(f,r)});else n.on(f,"submit",function(){o(this,r)});break}e.initialContent&&(e.autoClearinitialContent?(s=r.execCommand,r.execCommand=function(){return r.fireEvent("firstBeforeExecCommand"),s.apply(r,arguments)},this._setDefaultContent(e.initialContent)):this.setContent(e.initialContent,!1,!0)),n.isEmptyNode(r.body)&&(r.body.innerHTML="<p>"+(t.ie?"":"<br/>")+"</p>"),e.focus&&setTimeout(function(){r.focus(r.options.focusInEnd),!r.options.autoClearinitialContent&&r._selectionChange()},0),r.container||(r.container=i.parentNode),r._bindshortcutKeys(),r.isReady=1,r.fireEvent("ready"),e.onready&&e.onready.call(r);if(!t.ie||t.ie9above)n.on(r.body,["blur","focus"],function(n){var t=r.selection.getNative();if(n.type=="blur")t.rangeCount>0&&(r._bakRange=t.getRangeAt(0));else{try{r._bakRange&&t.addRange(r._bakRange)}catch(n){}r._bakRange=null}});!e.isShow&&r.setHide(),e.readonly&&r.setDisabled()},sync:function(t){var r=this,i=t?document.getElementById(t):n.findParent(r.body.parentNode,function(n){return n.tagName=="FORM"},!0);i&&o(i,r)},setHeight:function(n,i){!i&&(this.options.initialFrameHeight=n),this.options.autoHeightEnabled?(jQuery(this.body).css({"min-height":n+"px"}),t.ie&&t.version<=6&&this.container&&(this.container.style.height=n,this.container.style.setExpression("height","this.scrollHeight <= "+n+' ? "'+n+'px" : "auto"'))):jQuery(this.body).height(n)},setWidth:function(n){this.$container&&this.$container.width(n),jQuery(this.body).width(n-jQuery(this.body).css("padding-left").replace("px","")*1-jQuery(this.body).css("padding-right").replace("px","")*1)},addshortcutkey:function(n,t){var r={};t?r[n]=t:r=n,i.extend(this.shortcutkeys,r)},_bindshortcutKeys:function(){var t=this,i=this.shortcutkeys;t.addListener("keydown",function(r,u){var c=u.keyCode||u.which,e,h,l,f,o,s;for(e in i)for(h=i[e].split(","),l=0;f=h[l++];)f=f.split(":"),o=f[0],s=f[1],(/^(ctrl)(\+shift)?\+(\d+)$/.test(o.toLowerCase())||/^(\d+)$/.test(o))&&((RegExp.$1=="ctrl"?u.ctrlKey||u.metaKey:0)&&(RegExp.$2!=""?u[RegExp.$2.slice(1)+"Key"]:1)&&c==RegExp.$3||c==RegExp.$1)&&(t.queryCommandState(e,s)!=-1&&t.execCommand(e,s),n.preventDefault(u))})},getContent:function(n,t,r,u,f){var o=this,e;return n&&i.isFunction(n)&&(t=n,n=""),t?!t():!this.hasContents()?"":(o.fireEvent("beforegetcontent"),e=UM.htmlparser(o.body.innerHTML,u),o.filterOutputRule(e),o.fireEvent("aftergetcontent",e),e.toHtml(f))},getAllHtml:function(){var n=this,u=[],e="",r;return n.fireEvent("getAllHtml",u),t.ie&&t.version>8&&(r="",i.each(n.document.styleSheets,function(n){r+=n.href?'<link rel="stylesheet" type="text/css" href="'+n.href+'" />':"<style>"+n.cssText+"</style>"}),i.each(n.document.getElementsByTagName("script"),function(n){r+=n.outerHTML})),"<html><head>"+(n.options.charset?'<meta http-equiv="Content-Type" content="text/html; charset='+n.options.charset+'"/>':"")+(r||n.document.getElementsByTagName("head")[0].innerHTML)+u.join("\n")+"</head><body "+(f&&t.version<9?'class="view"':"")+">"+n.getContent(null,null,!0)+"</body></html>"},getPlainTxt:function(){var i=new RegExp(n.fillChar,"g"),t=this.body.innerHTML.replace(/[\n\r]/g,"");return t=t.replace(/<(p|div)[^>]*>(<br\/?>|&nbsp;)<\/\1>/gi,"\n").replace(/<br\/?>/gi,"\n").replace(/<[^>/]+>/g,"").replace(/(\n)?<\/([^>]+)>/g,function(n,t,i){return r.$block[i]?"\n":t?t:""}),t.replace(i,"").replace(/\u00a0/g," ").replace(/&nbsp;/g," ")},getContentTxt:function(){var i=new RegExp(n.fillChar,"g");return this.body[t.ie?"innerText":"textContent"].replace(i,"").replace(/\u00a0/g," ")},setContent:function(i,u,f){function v(n){return n.tagName=="DIV"&&n.getAttribute("cdata_tag")}var s=this,c,e,a,h,l;s.fireEvent("beforesetcontent",i),c=UM.htmlparser(i),s.filterInputRule(c),i=c.toHtml(),s.body.innerHTML=(u?s.body.innerHTML:"")+i;if(s.options.enterTag=="p"){e=this.body.firstChild;if(!e||e.nodeType==1&&(r.$cdata[e.tagName]||v(e)||n.isCustomeNode(e))&&e===this.body.lastChild)this.body.innerHTML="<p>"+(t.ie?"&nbsp;":"<br/>")+"</p>"+this.body.innerHTML;else{h=s.document.createElement("p");while(e){while(e&&(e.nodeType==3||e.nodeType==1&&r.p[e.tagName]&&!r.$cdata[e.tagName]))a=e.nextSibling,h.appendChild(e),e=a;if(h.firstChild)if(e)e.parentNode.insertBefore(h,e),h=s.document.createElement("p");else{s.body.appendChild(h);break}e=e.nextSibling}}}s.fireEvent("aftersetcontent"),s.fireEvent("contentchange"),!f&&s._selectionChange(),s._bakRange=s._bakIERange=s._bakNativeRange=null,t.gecko&&(l=this.selection.getNative())&&l.removeAllRanges(),s.options.autoSyncData&&s.form&&o(s.form,s)},focus:function(n){try{var i=this,t=i.selection.getRange();n?t.setStartAtLast(i.body.lastChild).setCursor(!1,!0):t.select(!0),this.fireEvent("focus")}catch(r){}},blur:function(){var n=this.selection.getNative();n.empty?n.empty():n.removeAllRanges(),this.fireEvent("blur")},isFocus:function(){return this.selection.isFocus()},_initEvents:function(){var t=this,r=t.body;t._proxyDomEvent=i.bind(t._proxyDomEvent,t);n.on(r,["click","contextmenu","mousedown","keydown","keyup","keypress","mouseup","mouseover","mouseout","selectstart"],t._proxyDomEvent);n.on(r,["focus","blur"],t._proxyDomEvent);n.on(r,["mouseup","keydown"],function(n){if(n.type=="keydown"&&(n.ctrlKey||n.metaKey||n.shiftKey||n.altKey))return;if(n.button==2)return;t._selectionChange(250,n)})},_proxyDomEvent:function(n){return this.fireEvent(n.type.replace(/^on/,""),n)},_selectionChange:function(n,i){var r=this,e=!1,o,u,f;t.ie&&t.version<9&&i&&i.type=="mouseup"&&(f=this.selection.getRange(),f.collapsed||(e=!0,o=i.clientX,u=i.clientY)),clearTimeout(c),c=setTimeout(function(){var n,t;if(!r.selection.getNative())return;if(e&&r.selection.getNative().type=="None"){n=r.document.body.createTextRange();try{n.moveToPoint(o,u)}catch(f){n=null}}n&&(t=r.selection.getIERange,r.selection.getIERange=function(){return n}),r.selection.cache(),t&&(r.selection.getIERange=t),r.selection._cachedRange&&r.selection._cachedStartElement&&(r.fireEvent("beforeselectionchange"),r.fireEvent("selectionchange",!!i),r.fireEvent("afterselectionchange"),r.selection.clear())},n||50)},_callCmdFn:function(n,t){t=Array.prototype.slice.call(t,0);var u=t.shift().toLowerCase(),i,r;return i=this.commands[u]||UM.commands[u],r=i&&i[n],(!i||!r)&&n=="queryCommandState"?0:r?r.apply(this,[u].concat(t)):void 0},execCommand:function(n){var r,t,u,i;return this.isFocus()||(r=this.selection._bakRange,r?r.select():this.focus(!0)),n=n.toLowerCase(),t=this,i=t.commands[n]||UM.commands[n],!i||!i.execCommand?null:(!i.notNeedUndo&&!t.__hasEnterExecCommand?(t.__hasEnterExecCommand=!0,t.queryCommandState.apply(t,arguments)!=-1&&(t.fireEvent("beforeexeccommand",n),u=this._callCmdFn("execCommand",arguments),!t._ignoreContentChange&&t.fireEvent("contentchange"),t.fireEvent("afterexeccommand",n)),t.__hasEnterExecCommand=!1):(u=this._callCmdFn("execCommand",arguments),!t._ignoreContentChange&&t.fireEvent("contentchange")),!t._ignoreContentChange&&t._selectionChange(),u)},queryCommandState:function(){try{return this._callCmdFn("queryCommandState",arguments)}catch(t){return 0}},queryCommandValue:function(){try{return this._callCmdFn("queryCommandValue",arguments)}catch(t){return null}},hasContents:function(t){var r,i,e,f,u;if(t)for(r=0;i=t[r++];)if(this.body.getElementsByTagName(i).length>0)return!0;if(!n.isEmptyBlock(this.body))return!0;for(t=["div"],r=0;i=t[r++];)for(e=n.getElementsByTagName(this.body,i),f=0;u=e[f++];)if(n.isCustomeNode(u))return!0;return!1},reset:function(){this.fireEvent("reset")},setEnabled:function(){var n=this,t;if(n.body.contentEditable=="false"){n.body.contentEditable=!0,t=n.selection.getRange();try{t.moveToBookmark(n.lastBk),delete n.lastBk}catch(i){t.setStartAtFirst(n.body).collapse(!0)}t.select(!0),n.bkqueryCommandState&&(n.queryCommandState=n.bkqueryCommandState,delete n.bkqueryCommandState),n.fireEvent("selectionchange")}},enable:function(){return this.setEnabled()},setDisabled:function(n){var t=this;n=n?i.isArray(n)?n:[n]:[],t.body.contentEditable=="true"&&(t.lastBk||(t.lastBk=t.selection.getRange().createBookmark(!0)),t.body.contentEditable=!1,t.bkqueryCommandState=t.queryCommandState,t.queryCommandState=function(r){return i.indexOf(n,r)!=-1?t.bkqueryCommandState.apply(t,arguments):-1},t.fireEvent("selectionchange"))},disable:function(n){return this.setDisabled(n)},_setDefaultContent:function(){function n(){var t=this;t.document.getElementById("initContent")&&(t.body.innerHTML="<p>"+(f?"":"<br/>")+"</p>",t.removeListener("firstBeforeExecCommand focus",n),setTimeout(function(){t.focus(),t._selectionChange()},0))}return function(t){var i=this;i.body.innerHTML='<p id="initContent">'+t+"</p>",i.addListener("firstBeforeExecCommand focus",n)}}(),setShow:function(){var n=this,t=n.selection.getRange();if(n.container.style.display=="none"){try{t.moveToBookmark(n.lastBk),delete n.lastBk}catch(i){t.setStartAtFirst(n.body).collapse(!0)}setTimeout(function(){t.select(!0)},100),n.container.style.display=""}},show:function(){return this.setShow()},setHide:function(){var n=this;n.lastBk||(n.lastBk=n.selection.getRange().createBookmark(!0)),n.container.style.display="none"},hide:function(){return this.setHide()},getLang:function(n){var t=UM.I18N[this.options.lang],r,i;if(!t)throw Error("not import language file");for(n=(n||"").split("."),r=0;i=n[r++];){t=t[i];if(!t)break}return t},getContentLength:function(n,t){var i=this.getContent(!1,!1,!0).length,u,r;if(n)for(t=(t||[]).concat(["hr","img","iframe"]),i=this.getContentTxt().replace(/[\t\r\n]+/g,"").length,u=0;r=t[u++];)i+=this.body.getElementsByTagName(r).length;return i},addInputRule:function(n,t){n.ignoreUndo=t,this.inputRules.push(n)},filterInputRule:function(n,t){for(var r=0,i;i=this.inputRules[r++];){if(t&&i.ignoreUndo)continue;i.call(this,n)}},addOutputRule:function(n,t){n.ignoreUndo=t,this.outputRules.push(n)},filterOutputRule:function(n,t){for(var r=0,i;i=this.outputRules[r++];){if(t&&i.ignoreUndo)continue;i.call(this,n)}}},i.inherits(h,e)})(),l=UM.filterWord=function(){function u(n){return/(class="?Mso|style="[^"]*\bmso\-|w:WordDocument|<v:)/ig.test(n)}function n(n){return n=n.replace(/[\d.]+\w+/g,function(n){return i.transUnitToPx(n)})}function r(r){return r.replace(/[\t\r\n]+/g,"").replace(/<!--[\s\S]*?-->/ig,"").replace(/<v:shape [^>]*>[\s\S]*?.<\/v:shape>/gi,function(i){if(t.opera)return"";try{var f=i.match(/width:([ \d.]*p[tx])/i)[1],u=i.match(/height:([ \d.]*p[tx])/i)[1],r=i.match(/src=\s*"([^"]*)"/i)[1];return'<img width="'+n(f)+'" height="'+n(u)+'" src="'+r+'" />'}catch(e){return""}}).replace(/<\/?div[^>]*>/g,"").replace(/v:\w+=(["']?)[^'"]+\1/g,"").replace(/<(!|script[^>]*>.*?<\/script(?=[>\s])|\/?(\?xml(:\w+)?|xml|meta|link|style|\w+:\w+)(?=[\s\/>]))[^>]*>/gi,"").replace(/<p [^>]*class="?MsoHeading"?[^>]*>(.*?)<\/p>/gi,"<p><strong>$1</strong></p>").replace(/\s+(class|lang|align)\s*=\s*(['"]?)([\w-]+)\2/ig,function(n,t,i,r){return t=="class"&&r=="MsoListParagraph"?n:""}).replace(/<(font|span)[^>]*>\s*<\/\1>/gi,"").replace(/(<[a-z][^>]*)\sstyle=(["'])([^\2]*?)\2/gi,function(t,i,r,u){for(var o=[],l=u.replace(/^\s+|\s+$/,"").replace(/&#39;/g,"'").replace(/&quot;/gi,"'").split(/;\s*/g),c,s,f,h,e=0;c=l[e];e++){h=c.split(":");if(h.length==2){s=h[0].toLowerCase(),f=h[1].toLowerCase();if(/^(background)\w*/.test(s)&&f.replace(/(initial|\s)/g,"").length==0||/^(margin)\w*/.test(s)&&/^0\w+$/.test(f))continue;switch(s){case"mso-padding-alt":case"mso-padding-top-alt":case"mso-padding-right-alt":case"mso-padding-bottom-alt":case"mso-padding-left-alt":case"mso-margin-alt":case"mso-margin-top-alt":case"mso-margin-right-alt":case"mso-margin-bottom-alt":case"mso-margin-left-alt":case"mso-height":case"mso-width":case"mso-vertical-align-alt":/<table/.test(i)||(o[e]=s.replace(/^mso-|-alt$/g,"")+":"+n(f));continue;case"horiz-align":o[e]="text-align:"+f;continue;case"vert-align":o[e]="vertical-align:"+f;continue;case"font-color":case"mso-foreground":o[e]="color:"+f;continue;case"mso-background":case"mso-highlight":o[e]="background:"+f;continue;case"mso-default-height":o[e]="min-height:"+n(f);continue;case"mso-default-width":o[e]="min-width:"+n(f);continue;case"mso-padding-between-alt":o[e]="border-collapse:separate;border-spacing:"+n(f);continue;case"text-line-through":(f=="single"||f=="double")&&(o[e]="text-decoration:line-through");continue;case"mso-zero-height":f=="yes"&&(o[e]="display:none");continue;case"margin":if(!/[1-9]/.test(f))continue}if(/^(mso|column|font-emph|lang|layout|line-break|list-image|nav|panose|punct|row|ruby|sep|size|src|tab-|table-border|text-(?:decor|trans)|top-bar|version|vnd|word-break)/.test(s)||/text\-indent|padding|margin/.test(s)&&/\-[\d.]+/.test(f))continue;o[e]=s+":"+h[1]}}return i+(o.length?' style="'+o.join(";").replace(/;{2,}/g,";")+'"':"")}).replace(/[\d.]+(cm|pt)/g,function(n){return i.transUnitToPx(n)})}return function(n){return u(n)?r(n):n}}(),(function(){function u(n,t,i){return n.push(h),t+(i?1:-1)}function t(n,t){for(var i=0;i<t;i++)n.push(l)}function f(n,i,e,o){switch(n.type){case"root":for(var h=0,s;s=n.children[h++];)e&&s.type=="element"&&!r.$inlineWithA[s.tagName]&&h>1&&(u(i,o,!0),t(i,o)),f(s,i,e,o);break;case"text":a(n,i);break;case"element":v(n,i,e,o);break;case"comment":c(n,i,e)}return i}function a(n,t){t.push(n.parentNode.tagName=="pre"?n.data:n.data.replace(/[ ]{2}/g," &nbsp;"))}function v(n,i,e,o){var s="",l,c,a,h;if(n.attrs){s=[],l=n.attrs;for(c in l)s.push(c+(l[c]!==undefined?'="'+l[c]+'"':""));s=s.join(" ")}i.push("<"+n.tagName+(s?" "+s:"")+(r.$empty[n.tagName]?"/":"")+">"),e&&!r.$inlineWithA[n.tagName]&&n.tagName!="pre"&&n.children&&n.children.length&&(o=u(i,o,!0),t(i,o));if(n.children&&n.children.length)for(a=0;h=n.children[a++];)e&&h.type=="element"&&!r.$inlineWithA[h.tagName]&&a>1&&(u(i,o),t(i,o)),f(h,i,e,o);r.$empty[n.tagName]||(e&&!r.$inlineWithA[n.tagName]&&n.tagName!="pre"&&n.children&&n.children.length&&(o=u(i,o),t(i,o)),i.push("</"+n.tagName+">"))}function c(n,t){t.push("<!--"+n.data+"-->")}function o(n,t){var u,r,i;if(n.type=="element"&&n.getAttr("id")==t)return n;if(n.children&&n.children.length)for(r=0;i=n.children[r++];)if(u=o(i,t))return u}function e(n,t,i){n.type=="element"&&n.tagName==t&&i.push(n);if(n.children&&n.children.length)for(var u=0,r;r=n.children[u++];)e(r,t,i)}function s(n,t){if(n.children&&n.children.length)for(var r=0,i;i=n.children[r];)s(i,t),i.parentNode&&(i.children&&i.children.length&&t(i),i.parentNode&&r++);else t(n)}var n=UM.uNode=function(n){this.type=n.type,this.data=n.data,this.tagName=n.tagName,this.parentNode=n.parentNode,this.attrs=n.attrs||{},this.children=n.children},l="    ",h="\n";n.createElement=function(t){return/[<>]/.test(t)?UM.htmlparser(t).children[0]:new n({type:"element",children:[],tagName:t})},n.createText=function(n,t){return new UM.uNode({type:"text",data:t?n:i.unhtml(n||"")})},n.prototype={toHtml:function(n){var t=[];return f(this,t,n,0),t.join("")},innerHTML:function(n){var f,t,u;if(this.type!="element"||r.$empty[this.tagName])return this;if(i.isString(n)){if(this.children)for(f=0;t=this.children[f++];)t.parentNode=null;for(this.children=[],u=UM.htmlparser(n),f=0;t=u.children[f++];)this.children.push(t),t.parentNode=this;return this}return u=new UM.uNode({type:"root",children:this.children}),u.toHtml()},innerText:function(t,i){if(this.type!="element"||r.$empty[this.tagName])return this;if(t){if(this.children)for(var f=0,u;u=this.children[f++];)u.parentNode=null;return this.children=[],this.appendChild(n.createText(t,i)),this}return this.toHtml().replace(/<[^>]+>/g,"")},getData:function(){return this.type=="element"?"":this.data},firstChild:function(){return this.children?this.children[0]:null},lastChild:function(){return this.children?this.children[this.children.length-1]:null},previousSibling:function(){for(var i=this.parentNode,t,n=0;t=i.children[n];n++)if(t===this)return n==0?null:i.children[n-1]},nextSibling:function(){for(var i=this.parentNode,t,n=0;t=i.children[n++];)if(t===this)return i.children[n]},replaceChild:function(n,t){if(this.children){n.parentNode&&n.parentNode.removeChild(n);for(var i=0,r;r=this.children[i];i++)if(r===t)return this.children.splice(i,1,n),t.parentNode=null,n.parentNode=this,n}},appendChild:function(n){if(this.type=="root"||this.type=="element"&&!r.$empty[this.tagName]){this.children||(this.children=[]),n.parentNode&&n.parentNode.removeChild(n);for(var t=0,i;i=this.children[t];t++)if(i===n){this.children.splice(t,1);break}return this.children.push(n),n.parentNode=this,n}},insertBefore:function(n,t){if(this.children){n.parentNode&&n.parentNode.removeChild(n);for(var i=0,r;r=this.children[i];i++)if(r===t)return this.children.splice(i,0,n),n.parentNode=this,n}},insertAfter:function(n,t){if(this.children){n.parentNode&&n.parentNode.removeChild(n);for(var i=0,r;r=this.children[i];i++)if(r===t)return this.children.splice(i+1,0,n),n.parentNode=this,n}},removeChild:function(n,t){var r,i,u,f;if(this.children)for(r=0;i=this.children[r];r++)if(i===n){this.children.splice(r,1),i.parentNode=null;if(t&&i.children&&i.children.length)for(u=0;f=i.children[u];u++)this.children.splice(r+u,0,f),f.parentNode=this;return i}},getAttr:function(n){return this.attrs&&this.attrs[n.toLowerCase()]},setAttr:function(n,t){if(!n){delete this.attrs;return}this.attrs||(this.attrs={});if(i.isObject(n))for(var r in n)n[r]?this.attrs[r.toLowerCase()]=n[r]:delete this.attrs[r];else t?this.attrs[n.toLowerCase()]=t:delete this.attrs[n]},getIndex:function(){for(var i=this.parentNode,t,n=0;t=i.children[n];n++)if(t===this)return n;return-1},getNodeById:function(n){var r,i,t;if(this.children&&this.children.length)for(i=0;t=this.children[i++];)if(r=o(t,n))return r},getNodesByTagName:function(n){n=i.trim(n).replace(/[ ]{2,}/g," ").split(" ");var r=[],t=this;return i.each(n,function(n){if(t.children&&t.children.length)for(var u=0,i;i=t.children[u++];)e(i,n,r)}),r},getStyle:function(n){var i=this.getAttr("style"),r,t;if(!i)return"";return r=new RegExp("(^|;)\\s*"+n+":([^;]+)","i"),t=i.match(r),t&&t[0]?t[2]:""},setStyle:function(n,t){function f(n,t){var u=new RegExp("(^|;)\\s*"+n+":([^;]+;?)","gi");r=r.replace(u,"$1"),t&&(r=n+":"+i.unhtml(t)+";"+r)}var r=this.getAttr("style"),u;r||(r="");if(i.isObject(n))for(u in n)f(u,n[u]);else f(n,t);this.setAttr("style",i.trim(r))},traversal:function(n){return this.children&&this.children.length&&s(this,n),this}}})(),c=UM.htmlparser=function(t,u){function h(n,t){if(a[n.tagName]){var i=o.createElement(a[n.tagName]);n.appendChild(i),i.appendChild(o.createText(t)),n=i}else n.appendChild(o.createText(t))}function p(n,t,u){var e,f,l,h,c,s;if(e=w[t]){f=n;while(f.type!="root"){if(i.isArray(e)?i.indexOf(e,f.tagName)!=-1:e==f.tagName){n=f,l=!0;break}f=f.parentNode}l||(n=p(n,i.isArray(e)?e[0]:e))}h=new o({parentNode:n,type:"element",tagName:t.toLowerCase(),children:r.$empty[t]?null:[]});if(u){c={};while(s=d.exec(u))c[s[1].toLowerCase()]=i.unhtml(s[2]||s[3]||s[4]);h.attrs=c}return n.children.push(h),r.$empty[t]?n:h}function b(n,t){n.children.push(new o({type:"comment",data:t,parentNode:n}))}var y=/<(?:(?:\/([^>]+)>)|(?:!--([\S|\s]*?)-->)|(?:([^\s\/>]+)\s*((?:(?:"[^"]*")|(?:'[^']*')|[^"'<>])*)\/?>))/g,d=/([\w\-:.]+)(?:(?:\s*=\s*(?:(?:"([^"]*)")|(?:'([^']*)')|([^\s>]+)))|(?=\s|$))/g,k={b:1,code:1,i:1,u:1,strike:1,s:1,tt:1,strong:1,q:1,samp:1,em:1,span:1,sub:1,img:1,sup:1,font:1,big:1,small:1,iframe:1,a:1,br:1,pre:1},v;t=t.replace(new RegExp(n.fillChar,"g"),""),u||(t=t.replace(new RegExp("[\\r\\t\\n"+(u?"":" ")+"]*</?(\\w+)\\s*(?:[^>]*)>[\\r\\t\\n"+(u?"":" ")+"]*","g"),function(n,t){return t&&k[t.toLowerCase()]?n.replace(/(^[\n\r]+)|([\n\r]+$)/g,""):n.replace(new RegExp("^[\\r\\n"+(u?"":" ")+"]+"),"").replace(new RegExp("[\\r\\n"+(u?"":" ")+"]+$"),"")}));var o=UM.uNode,w={td:"tr",tr:["tbody","thead","tfoot"],tbody:"table",th:"tr",thead:"table",tfoot:"table",caption:"table",li:["ul","ol"],dt:"dl",dd:"dl",option:"select"},a={ol:"li",ul:"li"};var e,c=0,s=0,l=new o({type:"root",children:[]}),f=l;while(e=y.exec(t)){c=e.index;try{c>s&&h(f,t.slice(s,c));if(e[3])r.$cdata[f.tagName]?h(f,e[0]):f=p(f,e[3].toLowerCase(),e[4]);else if(e[1]){if(f.type!="root")if(r.$cdata[f.tagName]&&!r.$cdata[e[1]])h(f,e[0]);else{v=f;while(f.type=="element"&&f.tagName!=e[1].toLowerCase()){f=f.parentNode;if(f.type=="root"){f=v;throw"break";}}f=f.parentNode}}else e[2]&&b(f,e[2])}catch(g){}s=y.lastIndex}return s<t.length&&h(f,t.slice(s)),l},a=UM.filterNode=function(){function n(t,u){var s,h,y,c,o,v,l,a,f,e;switch(t.type){case"element":if(s=u[t.tagName])if(s==="-")t.parentNode.removeChild(t);else if(i.isFunction(s)){l=t.parentNode,a=t.getIndex(),s(t);if(t.parentNode){if(t.children)for(f=0;e=t.children[f];)n(e,u),e.parentNode&&f++}else for(f=a;e=l.children[f];)n(e,u),e.parentNode&&f++}else{h=s.$;if(h&&t.attrs){y={};for(o in h)c=t.getAttr(o),o=="style"&&i.isArray(h[o])&&(v=[],i.each(h[o],function(n){var i;(i=t.getStyle(n))&&v.push(n+":"+i)}),c=v.join(";")),c&&(y[o]=c);t.attrs=y}if(t.children)for(f=0;e=t.children[f];)n(e,u),e.parentNode&&f++}else if(r.$cdata[t.tagName])t.parentNode.removeChild(t);else for(l=t.parentNode,a=t.getIndex(),t.parentNode.removeChild(t,!0),f=a;e=l.children[f];)n(e,u),e.parentNode&&f++;break;case"comment":t.parentNode.removeChild(t)}}return function(t,r){var e,u,f;if(i.isEmptyObject(r))return t;for((e=r["-"])&&i.each(e.split(" "),function(n){r[n]="-"}),u=0;f=t.children[u];)n(f,r),f.parentNode&&u++;return t}}(),UM.commands.inserthtml={execCommand:function(u,f,e){var a=this,s,b,d,c,h,p,w,g,v,k,y,tt,l,nt;if(!f)return;if(a.fireEvent("beforeinserthtml",f)===!0)return;s=a.selection.getRange(),b=s.document.createElement("div"),b.style.display="inline",e||(d=UM.htmlparser(f),a.options.filterRules&&UM.filterNode(d,a.options.filterRules),a.filterInputRule(d),f=d.toHtml()),b.innerHTML=i.trim(f);if(!s.collapsed){c=s.startContainer,n.isFillChar(c)&&s.setStartBefore(c),c=s.endContainer,n.isFillChar(c)&&s.setEndAfter(c),s.txtToElmBoundary(),s.endContainer&&s.endContainer.nodeType==1&&(c=s.endContainer.childNodes[s.endOffset],c&&n.isBr(c)&&s.setEndAfter(c)),s.startOffset==0&&(c=s.startContainer,n.isBoundaryNode(c,"firstChild")&&(c=s.endContainer,s.endOffset==(c.nodeType==3?c.nodeValue.length:c.childNodes.length)&&n.isBoundaryNode(c,"lastChild")&&(a.body.innerHTML="<p>"+(t.ie?"":"<br/>")+"</p>",s.setStart(a.body.firstChild,0).collapse(!0)))),!s.collapsed&&s.deleteContents();if(s.startContainer.nodeType==1){h=s.startContainer.childNodes[s.startOffset];if(h&&n.isBlockElm(h)&&(l=h.previousSibling)&&n.isBlockElm(l)){s.setEnd(l,l.childNodes.length).collapse();while(h.firstChild)l.appendChild(h.firstChild);n.remove(h)}}}g=0,s.inFillChar()&&(h=s.startContainer,n.isFillChar(h)?(s.setStartBefore(h).collapse(!0),n.remove(h)):n.isFillChar(h,!0)&&(h.nodeValue=h.nodeValue.replace(o,""),s.startOffset--,s.collapsed&&s.collapse(!0)));while(h=b.firstChild){if(g){k=a.document.createElement("p");while(h&&(h.nodeType==3||!r.$block[h.tagName]))v=h.nextSibling,k.appendChild(h),h=v;k.firstChild&&(h=k)}s.insertNode(h),v=h.nextSibling;if(!g&&h.nodeType==n.NODE_ELEMENT&&n.isBlockElm(h)){p=n.findParent(h,function(t){return n.isBlockElm(t)});if(p&&p.tagName.toLowerCase()!="body"&&!(r[p.tagName][h.nodeName]&&h.parentNode===p)){if(r[p.tagName][h.nodeName]){w=h.parentNode;while(w!==p)l=w,w=w.parentNode}else l=p;n.breakParent(h,l||w),l=h.previousSibling,n.trimWhiteTextNode(l),l.childNodes.length||n.remove(l),!t.ie&&(y=h.nextSibling)&&n.isBlockElm(y)&&y.lastChild&&!n.isBr(y.lastChild)&&y.appendChild(a.document.createElement("br")),g=1}}y=h.nextSibling;if(!b.firstChild&&y&&n.isBlockElm(y)){s.setStart(y,0).collapse(!0);break}s.setEndAfter(h).collapse()}h=s.startContainer,v&&n.isBr(v)&&n.remove(v);if(n.isBlockElm(h)&&n.isEmptyNode(h))if(v=h.nextSibling)n.remove(h),v.nodeType==1&&r.$block[v.tagName]&&s.setStart(v,0).collapse(!0).shrinkBoundary();else try{h.innerHTML=t.ie?n.fillChar:"<br/>"}catch(it){s.setStartBefore(h),n.remove(h)}try{t.ie9below&&s.startContainer.nodeType==1&&!s.startContainer.childNodes[s.startOffset]&&(tt=s.startContainer,l=tt.childNodes[s.startOffset-1],l&&l.nodeType==1&&r.$empty[l.tagName]&&(nt=this.document.createTextNode(n.fillChar),s.insertNode(nt).setStart(nt,0).collapse(!0))),s.select(!0)}catch(it){}setTimeout(function(){s=a.selection.getRange(),s.scrollIntoView(),a.fireEvent("afterinserthtml")},200)}},UM.commands.insertimage={execCommand:function(n,t){var e;t=i.isArray(t)?t:[t];if(!t.length)return;var o=this,f=[],u="",r;r=t[0];if(t.length==1)u='<img class="attach-item image" src="'+r.src+'" '+(r._src?' _src="'+r._src+'" ':"")+(r.width?'width="'+r.width+'" ':"")+(r.height?' height="'+r.height+'" ':"")+(r.floatStyle=="left"||r.floatStyle=="right"?' style="float:'+r.floatStyle+';"':"")+(r.title&&r.title!=""?' title="'+r.title+'"':"")+(r.border&&r.border!="0"?' border="'+r.border+'"':"")+(r.alt&&r.alt!=""?' alt="'+r.alt+'"':"")+(r.hspace&&r.hspace!="0"?' hspace = "'+r.hspace+'"':"")+(r.vspace&&r.vspace!="0"?' vspace = "'+r.vspace+'"':"")+"/>",r.floatStyle=="center"&&(u='<p style="text-align: center">'+u+"</p>"),f.push(u);else for(e=0;r=t[e++];)u="<p "+(r.floatStyle=="center"?'style="text-align: center" ':"")+'><img  class="attach-item image" src="'+r.src+'" '+(r.width?'width="'+r.width+'" ':"")+(r._src?' _src="'+r._src+'" ':"")+(r.height?' height="'+r.height+'" ':"")+' style="'+(r.floatStyle&&r.floatStyle!="center"?"float:"+r.floatStyle+";":"")+(r.border||"")+'" '+(r.title?' title="'+r.title+'"':"")+" /></p>",f.push(u);o.execCommand("insertHtml",f.join(""),!0)}},UM.commands.attach={execCommand:function(){var i=this;try{parent.OpenFile("open","\u63d2\u5165\u9644\u4ef6\u6216\u56fe\u7247",{attach:["\u9644\u4ef6",["ATTACH","IMAGE"],""]},{multiple:!0},function(n){var t,e,r,u,f;t=n.params.multiple?n.icodata:[n.icodata],e="<p>";for(r in t)u="",f="",u=t[r].aid>0?encodeURIComponent("attach::"+t[r].aid):encodeURIComponent(t[r].path),jQuery.inArray(t[r].ext,["jpg","jpeg","png","gif","bmp"])>-1?(f=DZZSCRIPT+"?mod=io&op=thumbnail&width=700&height=500&original=1&path="+u,e+="<img class='attach-item image' path='"+u+"' src='"+f+"' _src='"+f+"' />"):(f=DZZSCRIPT+"?mod=io&op=system&op=attatchment&path="+u,e+=" <span class='attach-item' path='"+u+"'><img src='"+t[r].img+"' _src='"+t[r].img+"' /><a href='"+f+"' _href='"+f+"' title='"+t[r].name+"' target='_blank'>"+t[r].name+"</a></span>");e+="</p>",i.execCommand("insertHtml",e,!0)})}catch(r){}}},UM.commands.image={execCommand:function(){var i=this;url=i.options.imageUrl,url=url+(url.indexOf("?")==-1?"?":"&")+"editorid="+i.id,jQuery(".edui-image-form").attr("action",url);jQuery(document).on("change",".edui-btn-image  .edui-image-upfile",function(){jQuery(this).parent().submit()})}},UM.commands.autosubmit={execCommand:function(){var t=this,n=document.getElementById(t.options.formid);n&&(jQuery("#reversion").val("0"),jQuery("#autosave").val("0"),n.onsubmit())}},UM.commands.save={execCommand:function(){var t=this,n=document.getElementById(t.options.formid);n&&(jQuery("#reversion").val("0"),jQuery("#autosave").val("0"),n.onsubmit())}},UM.commands.save_new={execCommand:function(){var t=this,n=document.getElementById(t.options.formid);n&&(jQuery("#reversion").val("1"),jQuery("#autosave").val("0"),n.onsubmit())}},UM.plugins.justify=function(){jQuery.each("justifyleft justifyright justifycenter justifyfull".split(" "),function(n,t){UM.commands[t]={execCommand:function(n){return this.document.execCommand(n)},queryCommandValue:function(n){var t=this.document.queryCommandValue(n);return t===!0||t==="true"?n.replace(/justify/,""):""},queryCommandState:function(n){return this.document.queryCommandState(n)?1:0}}})},UM.plugins.font=function(){var n=this,f={forecolor:"forecolor",backcolor:"backcolor",fontsize:"fontsize",fontfamily:"fontname"},u={forecolor:"color",backcolor:"background-color",fontsize:"font-size",fontfamily:"font-family"},e={forecolor:"color",fontsize:"size",fontfamily:"face"},r;n.setOpt({fontfamily:[{name:"songti",val:"\u5b8b\u4f53,SimSun"},{name:"yahei",val:"\u5fae\u8f6f\u96c5\u9ed1,Microsoft YaHei"},{name:"kaiti",val:"\u6977\u4f53,\u6977\u4f53_GB2312, SimKai"},{name:"heiti",val:"\u9ed1\u4f53, SimHei"},{name:"lishu",val:"\u96b6\u4e66, SimLi"},{name:"andaleMono",val:"andale mono"},{name:"arial",val:"arial, helvetica,sans-serif"},{name:"arialBlack",val:"arial black,avant garde"},{name:"comicSansMs",val:"comic sans ms"},{name:"impact",val:"impact,chicago"},{name:"timesNewRoman",val:"times new roman"},{name:"sans-serif",val:"sans-serif"}],fontsize:[10,12,16,18,24,32,48]}),n.addOutputRule(function(n){i.each(n.getNodesByTagName("font"),function(n){var i,t,r;if(n.tagName=="font"){i=[];for(t in n.attrs)switch(t){case"size":r=n.attrs[t],jQuery.each({"10":"1","12":"2","16":"3","18":"4","24":"5","32":"6","48":"7"},function(n,t){if(t==r)return r=n,!1}),i.push("font-size:"+r+"px");break;case"color":i.push("color:"+n.attrs[t]);break;case"face":i.push("font-family:"+n.attrs[t]);break;case"style":i.push(n.attrs[t])}n.attrs={style:i.join(";")}}n.tagName="span",n.parentNode.tagName=="span"&&n.parentNode.children.length==1&&(jQuery.each(n.attrs,function(t,i){n.parentNode.attrs[t]=t=="style"?n.parentNode.attrs[t]+i:i}),n.parentNode.removeChild(n,!0))})});for(r in f)(function(r){UM.commands[r]={execCommand:function(n,i){var r,e;if(i=="transparent")return;r=this.selection.getRange();if(r.collapsed)e=jQuery("<span></span>").css(u[n],i)[0],r.insertNode(e).setStart(e,0).setCursor();else{n=="fontsize"&&(i=({"10":"1","12":"2","16":"3","18":"4","24":"5","32":"6","48":"7"})[(i+"").replace(/px/,"")]),this.document.execCommand(f[n],!1,i),t.gecko&&jQuery.each(this.$body.find("a"),function(n,t){var i=t.parentNode,r;i.lastChild===i.firstChild&&/FONT|SPAN/.test(i.tagName)&&(r=i.cloneNode(!1),r.innerHTML=t.innerHTML,jQuery(t).html("").append(r).insertBefore(i),jQuery(i).remove())});if(!t.ie){var h=this.selection.getNative().getRangeAt(0),s=h.commonAncestorContainer,r=this.selection.getRange(),o=r.createBookmark(!0);jQuery(s).find("a").each(function(n,t){var r=t.parentNode,i;r.nodeName=="FONT"&&(i=r.cloneNode(!1),i.innerHTML=t.innerHTML,jQuery(t).html("").append(i))}),r.moveToBookmark(o).select()}return!0}},queryCommandValue:function(t){var f=n.selection.getStart(),r=jQuery(f).css(u[t]);return r===undefined&&(r=jQuery(f).attr(e[t])),r?i.fixColor(t,r).replace(/px/,""):""},queryCommandState:function(n){return this.queryCommandValue(n)}}})(r)},UM.plugins.link=function(){this.setOpt("autourldetectinie",!1),t.ie&&this.options.autourldetectinie===!1&&this.addListener("keyup",function(t,i){var o=this,f=i.keyCode,e,r,u;(f==13||f==32)&&(e=o.selection.getRange(),r=e.startContainer,f==13?r.nodeName=="P"&&(u=r.previousSibling,u&&u.nodeType==1&&(u=u.lastChild,u&&u.nodeName=="A"&&!u.getAttribute("_href")&&n.remove(u,!0))):f==32&&r.nodeType==3&&/^\s$/.test(r.nodeValue)&&(r=r.previousSibling,r&&r.nodeName=="A"&&!r.getAttribute("_href")&&n.remove(r,!0)))}),this.addOutputRule(function(n){jQuery.each(n.getNodesByTagName("a"),function(n,t){var r=i.html(t.getAttr("_href"));r&&(/^(ftp|https?|\/|file)/.test(r)||(r=""+r),t.setAttr("href",r),t.setAttr("_href")),t.getAttr("title")==""&&t.setAttr("title")})}),this.addInputRule(function(n){jQuery.each(n.getNodesByTagName("a"),function(n,t){t.setAttr("_href",i.html(t.getAttr("href")))})}),UM.commands.link={execCommand:function(t,r){var e=this,u=e.selection.getRange(),f;u.collapsed?(f=u.startContainer,(f=n.findParentByTagName(f,"a",!0))?(jQuery(f).attr(r),u.selectNode(f).select()):u.insertNode(jQuery("<a>"+r.href+"</a>").attr(r)[0]).select()):(e.document.execCommand("createlink",!1,"_umeditor_link"),i.each(n.getElementsByTagName(e.body,"a",function(n){return n.getAttribute("href")=="_umeditor_link"}),function(t){jQuery(t).text()=="_umeditor_link"&&jQuery(t).text(r.href),n.setAttributes(t,r),u.selectNode(t).select()}))},queryCommandState:function(){return this.queryCommandValue("link")?1:0},queryCommandValue:function(){var t=this.selection.getStartElementPath(),n;return jQuery.each(t,function(t,i){if(i.nodeName=="A")return n=i,!1}),n}},UM.commands.unlink={execCommand:function(){this.document.execCommand("unlink")}}},UM.commands.print={execCommand:function(){var r=this,n="editor_print_"+ +new Date,i,t;jQuery('<iframe src="" id="'+n+'" name="'+n+'" frameborder="0"></iframe>').attr("id",n).css({width:"0px",height:"0px",overflow:"hidden","float":"left",position:"absolute",top:"-10000px",left:"-10000px"}).appendTo(r.$container.find(".edui-dialog-container")),i=window.open("",n,""),t=i.document,t.open(),t.write("<html><head></head><body><div>"+this.getContent(null,null,!0)+"</div><script>setTimeout(function(){window.print();setTimeout(function(){window.parent.jQuery('#"+n+"').remove();},100);},200);<\/script></body></html>"),t.close()},notNeedUndo:1},UM.plugins.paragraph=function(){var n=this;n.setOpt("paragraph",{p:"",h1:"",h2:"",h3:"",h4:"",h5:"",h6:""}),n.commands.paragraph={execCommand:function(n,t){return this.document.execCommand("formatBlock",!1,"<"+t+">")},queryCommandValue:function(){try{var n=this.document.queryCommandValue("formatBlock")}catch(t){}return n}}},UM.plugins.horizontal=function(){var i=this;i.commands.horizontal={execCommand:function(){var f,u,s,h,e,o;this.document.execCommand("insertHorizontalRule"),f=i.selection.getRange().txtToElmBoundary(!0),u=f.startContainer;if(n.isBody(f.startContainer))s=f.startContainer.childNodes[f.startOffset],s||(s=jQuery("<p></p>").appendTo(f.startContainer).html(t.ie?"&nbsp;":"<br/>")[0]),f.setStart(s,0).setCursor();else{while(r.$inline[u.tagName]&&u.lastChild===u.firstChild)h=u.parentNode,h.appendChild(u.firstChild),h.removeChild(u),u=h;while(r.$inline[u.tagName])u=u.parentNode;u.childNodes.length==1&&u.lastChild.nodeName=="HR"?(e=u.lastChild,jQuery(e).insertBefore(u),f.setStart(u,0).setCursor()):(e=jQuery("hr",u)[0],n.breakParent(e,u),o=e.previousSibling,o&&n.isEmptyBlock(o)&&jQuery(o).remove(),f.setStart(e.nextSibling,0).setCursor())}}}},UM.commands.cleardoc={execCommand:function(){var n=this,t=n.selection.getRange();n.body.innerHTML="<p>"+(f?"":"<br/>")+"</p>",t.setStart(n.body.firstChild,0).setCursor(!1,!0),setTimeout(function(){n.fireEvent("clearDoc")},0)}},UM.plugins.undo=function(){function c(n,t){if(n.length!=t.length)return 0;for(var i=0,r=n.length;i<r;i++)if(n[i]!=t[i])return 0;return 1}function g(n,t){return n.collapsed!=t.collapsed?0:!c(n.startAddress,t.startAddress)||!c(n.endAddress,t.endAddress)?0:1}function k(){this.list=[],this.index=0,this.hasUndo=!1,this.hasRedo=!1,this.undo=function(){if(this.hasUndo){if(!this.list[this.index-1]&&this.list.length==1){this.reset();return}while(this.list[this.index].content==this.list[this.index-1].content){this.index--;if(this.index==0)return this.restore(0)}this.restore(--this.index)}},this.redo=function(){if(this.hasRedo){while(this.list[this.index].content==this.list[this.index+1].content){this.index++;if(this.index==this.list.length-1)return this.restore(this.index)}this.restore(++this.index)}},this.restore=function(){var f=this.editor,s=this.list[this.index],h=UM.htmlparser(s.content.replace(d,"")),e,o;f.options.autoClearEmptyNode=!1,f.filterInputRule(h,!0),f.options.autoClearEmptyNode=y,f.body.innerHTML=h.toHtml(),f.fireEvent("afterscencerestore"),t.ie&&i.each(n.getElementsByTagName(f.document,"td th caption p"),function(t){n.isEmptyNode(t)&&n.fillNode(f.document,t)});try{e=new u.Range(f.document,f.body).moveToAddress(s.address),t.ie&&e.collapsed&&e.startContainer.nodeType==1&&(o=e.startContainer.childNodes[e.startOffset],(!o||o.nodeType==1&&r.$empty[o])&&e.insertNode(f.document.createTextNode(" ")).collapse(!0)),e.select(p[e.startContainer.nodeName.toLowerCase()])}catch(c){}this.update(),this.clearKey(),f.fireEvent("reset",!0)},this.getScene=function(){var n=this.editor,f=n.selection.getRange(),u=f.createAddress(!1,!0),r,i;return n.fireEvent("beforegetscene"),r=UM.htmlparser(n.body.innerHTML,!0),n.options.autoClearEmptyNode=!1,n.filterOutputRule(r,!0),n.options.autoClearEmptyNode=y,i=r.toHtml(),t.ie&&(i=i.replace(/>&nbsp;</g,"><").replace(/\s*</g,"<").replace(/>\s*/g,">")),n.fireEvent("aftergetscene"),{address:u,content:i}},this.save=function(n,t){clearTimeout(s);var r=this.getScene(t),i=this.list[this.index];if(i&&i.content==r.content&&(n?1:g(i.address,r.address)))return;this.list=this.list.slice(0,this.index+1),this.list.push(r),this.list.length>w&&this.list.shift(),this.index=this.list.length-1,this.clearKey(),this.update()},this.update=function(){this.hasRedo=!!this.list[this.index+1],this.hasUndo=!!this.list[this.index-1]},this.reset=function(){this.list=[],this.index=0,this.hasUndo=!1,this.hasRedo=!1,this.clearKey()},this.clearKey=function(){h=0,a=null}}function v(){this.undoManger.save()}var s,f=this,w=f.options.maxUndoCount||20,b=f.options.maxInputCount||20,d=new RegExp(n.fillChar+"|</hr>","gi"),p={ol:1,ul:1,table:1,tbody:1,tr:1,body:1},y=f.options.autoClearEmptyNode,o;f.undoManger=new k,f.undoManger.editor=f,f.addListener("saveScene",function(){var n=Array.prototype.splice.call(arguments,1);this.undoManger.save.apply(this.undoManger,n)}),f.addListener("beforeexeccommand",v),f.addListener("afterexeccommand",v),f.addListener("reset",function(n,t){t||this.undoManger.reset()}),f.commands.redo=f.commands.undo={execCommand:function(n){this.undoManger[n]()},queryCommandState:function(n){return this.undoManger["has"+(n.toLowerCase()=="undo"?"Undo":"Redo")]?0:-1},notNeedUndo:1};var l={16:1,17:1,18:1,37:1,38:1,39:1,40:1},h=0,a,e=!1;f.addListener("ready",function(){n.on(this.body,"compositionstart",function(){e=!0});n.on(this.body,"compositionend",function(){e=!1})}),f.addshortcutkey({Undo:"ctrl+90",Redo:"ctrl+89,shift+ctrl+z"}),o=!0,f.addListener("keydown",function(n,t){var i=this,u=t.keyCode||t.which;if(!l[u]&&!t.ctrlKey&&!t.metaKey&&!t.shiftKey&&!t.altKey){if(e)return;if(!i.selection.getRange().collapsed){i.undoManger.save(!1,!0),o=!1;return}i.undoManger.list.length==0&&i.undoManger.save(!0),clearTimeout(s);function r(n){n.selection.getRange().collapsed&&n.fireEvent("contentchange"),n.undoManger.save(!1,!0),n.fireEvent("selectionchange")}s=setTimeout(function(){if(e){var n=setInterval(function(){e||(r(i),clearInterval(n))},300);return}r(i)},200),a=u,h++,h>=b&&r(i)}}),f.addListener("keyup",function(n,t){var i=t.keyCode||t.which;if(!l[i]&&!t.ctrlKey&&!t.metaKey&&!t.shiftKey&&!t.altKey){if(e)return;o||(this.undoManger.save(!1,!0),o=!0)}})},UM.plugins.paste=function(){function f(i){var u=this.document;if(u.getElementById("baidu_pastebin"))return;var f=this.selection.getRange(),e=f.createBookmark(),r=u.createElement("div");r.id="baidu_pastebin",t.webkit&&r.appendChild(u.createTextNode(n.fillChar+n.fillChar)),this.body.appendChild(r),e.start.style.display="",r.style.cssText="position:absolute;width:1px;height:1px;overflow:hidden;left:-1000px;top:"+jQuery(e.start).position().top+"px",f.selectNodeContents(r).select(!0),setTimeout(function(){if(t.webkit)for(var h=0,s=u.querySelectorAll("#baidu_pastebin"),o;o=s[h++];)if(n.isEmptyNode(o))n.remove(o);else{r=o;break}try{r.parentNode.removeChild(r)}catch(c){}f.moveToBookmark(e).select(!0),i(r)},0)}function u(u){var e,w,v,d,l,b,h,y,k,a,g,p,f,o,s,c;if(u.firstChild){for(w=n.getElementsByTagName(u,"span"),f=0;v=w[f++];)(v.id=="_baidu_cut_start"||v.id=="_baidu_cut_end")&&n.remove(v);if(t.webkit){for(a=u.querySelectorAll("div br"),f=0;d=a[f++];)l=d.parentNode,l.tagName=="DIV"&&l.childNodes.length==1&&(l.innerHTML="<p><br/></p>",n.remove(l));for(b=u.querySelectorAll("#baidu_pastebin"),f=0;h=b[f++];){y=r.document.createElement("p"),h.parentNode.insertBefore(y,h);while(h.firstChild)y.appendChild(h.firstChild);n.remove(h)}for(k=u.querySelectorAll("meta"),f=0;o=k[f++];)n.remove(o);for(a=u.querySelectorAll("br"),f=0;o=a[f++];)/^apple-/i.test(o.className)&&n.remove(o)}if(t.gecko)for(g=u.querySelectorAll("[_moz_dirty]"),f=0;o=g[f++];)o.removeAttribute("_moz_dirty");if(!t.ie)for(p=u.querySelectorAll("span.Apple-style-span"),f=0;o=p[f++];)n.remove(o,!0);e=u.innerHTML,e=UM.filterWord(e),s=UM.htmlparser(e),r.options.filterRules&&UM.filterNode(s,r.options.filterRules),r.filterInputRule(s),t.webkit&&(c=s.lastChild(),c&&c.type=="element"&&c.tagName=="br"&&s.removeChild(c),i.each(r.body.querySelectorAll("div"),function(t){n.isEmptyBlock(t)&&n.remove(t)})),e={html:s.toHtml()},r.fireEvent("beforepaste",e,s);if(!e.html)return;r.execCommand("insertHtml",e.html,!0),r.fireEvent("afterpaste",e)}}var r=this;r.addListener("ready",function(){n.on(r.body,"cut",function(){var n=r.selection.getRange();!n.collapsed&&r.undoManger&&r.undoManger.save()});n.on(r.body,t.ie||t.opera?"keydown":"paste",function(n){if((t.ie||t.opera)&&(!n.ctrlKey&&!n.metaKey||n.keyCode!="86"))return;f.call(r,function(n){u(n)})})})},UM.plugins.list=function(){var n=this;n.setOpt({insertorderedlist:{decimal:"","lower-alpha":"","lower-roman":"","upper-alpha":"","upper-roman":""},insertunorderedlist:{circle:"",disc:"",square:""}}),this.addInputRule(function(n){i.each(n.getNodesByTagName("li"),function(n){n.children.length==0&&n.parentNode.removeChild(n)})}),n.commands.insertorderedlist=n.commands.insertunorderedlist={execCommand:function(n){this.document.execCommand(n);var t=this.selection.getRange(),i=t.createBookmark(!0);return this.$body.find("ol,ul").each(function(n,t){var i=t.parentNode;i.tagName=="P"&&i.lastChild===i.firstChild&&(jQuery(t).children().each(function(n,t){var r=i.cloneNode(!1);jQuery(r).append(t.innerHTML),jQuery(t).html("").append(r)}),jQuery(t).insertBefore(i),jQuery(i).remove())}),t.moveToBookmark(i).select(),!0},queryCommandState:function(n){return this.document.queryCommandState(n)}}},(function(){var n={textarea:function(n,i){var r=i.ownerDocument.createElement("textarea");return r.style.cssText="resize:none;border:0;padding:0;margin:0;overflow-y:auto;outline:0;width:100%;",i.appendChild(r),{container:r,setContent:function(n){r.value=n},getContent:function(){return r.value},select:function(){var n;t.ie?(n=r.createTextRange(),n.collapse(!0),n.select()):(r.setSelectionRange(0,0),r.focus())},dispose:function(){i.removeChild(r),i.onresize=null,r=null,i=null}}}};UM.plugins.source=function(){function h(t){return n.textarea(i,t)}var i=this,c=this.options,f=!1,u,l,s,o,e;c.sourceEditor="textarea",i.setOpt({sourceEditorFirst:!1}),s=i.getContent,i.commands.source={execCommand:function(){var e,c,a,n,l;f=!f;if(f)o=i.selection.getRange().createAddress(!1,!0),i.undoManger&&i.undoManger.save(!0),t.gecko&&(i.body.contentEditable=!1),i.body.style.cssText+=";position:absolute;left:-32768px;top:-32768px;",i.fireEvent("beforegetcontent"),e=UM.htmlparser(i.body.innerHTML),i.filterOutputRule(e),e.traversal(function(n){if(n.type=="element")switch(n.tagName){case"td":case"th":case"caption":n.children&&n.children.length==1&&n.firstChild().tagName=="br"&&n.removeChild(n.firstChild());break;case"pre":n.innerText(n.innerText().replace(/&nbsp;/g," "))}}),i.fireEvent("aftergetcontent"),c=e.toHtml(!0),u=h(i.body.parentNode),u.setContent(c),a=function(n){return parseInt(jQuery(i.body).css(n))},jQuery(u.container).width("100%").height(jQuery(i.body).height()),setTimeout(function(){u.select()}),i.getContent=function(){return u.getContent()||"<p>"+(t.ie?"":"<br/>")+"</p>"};else{i.$body.css({position:"",left:"",top:""}),n=u.getContent()||"<p>"+(t.ie?"":"<br/>")+"</p>",n=n.replace(new RegExp("[\\r\\t\\n ]*</?(\\w+)\\s*(?:[^>]*)>","g"),function(n,t){return t&&!r.$inlineWithA[t.toLowerCase()]?n.replace(/(^[\n\r\t ]*)|([\n\r\t ]*$)/g,""):n.replace(/(^[\n\r\t]*)|([\n\r\t]*$)/g,"")}),i.setContent(n),u.dispose(),u=null,i.getContent=s,l=i.body.firstChild,l||(i.body.innerHTML="<p>"+(t.ie?"":"<br/>")+"</p>"),i.undoManger&&i.undoManger.save(!0),t.gecko&&(i.body.contentEditable=!0);try{i.selection.getRange().moveToAddress(o).select()}catch(v){}}this.fireEvent("sourcemodechanged",f)},queryCommandState:function(){return f|0},notNeedUndo:1},e=i.queryCommandState,i.queryCommandState=function(n){return n=n.toLowerCase(),f?n in{source:1,fullscreen:1}?e.apply(this,arguments):-1:e.apply(this,arguments)}}})(),UM.plugins.enterkey=function(){var r,i=this,u=i.options.enterTag;i.addListener("keyup",function(u,f){var v=f.keyCode||f.which,o,c,l,a,s,e,h;if(v==13){o=i.selection.getRange(),c=o.startContainer;if(t.ie)i.fireEvent("saveScene",!0,!0);else{if(/h\d/i.test(r)){if(t.gecko)a=n.findParentByTagName(c,["h1","h2","h3","h4","h5","h6","blockquote","caption","table"],!0),a||(i.document.execCommand("formatBlock",!1,"<p>"),l=1);else if(c.nodeType==1){s=i.document.createTextNode(""),o.insertNode(s),e=n.findParentByTagName(s,"div",!0);if(e){h=i.document.createElement("p");while(e.firstChild)h.appendChild(e.firstChild);e.parentNode.insertBefore(h,e),n.remove(e),o.setStartBefore(s).setCursor(),l=1}n.remove(s)}i.undoManger&&l&&i.undoManger.save()}t.opera&&o.select()}}}),i.addListener("keydown",function(f,e){var l=e.keyCode||e.which,s;if(l==13){if(i.fireEvent("beforeenterkeydown")){n.preventDefault(e);return}i.fireEvent("saveScene",!0,!0),r="",s=i.selection.getRange();if(!s.collapsed){var o=s.startContainer,a=s.endContainer,h=n.findParentByTagName(o,"td",!0),c=n.findParentByTagName(a,"td",!0);if(h&&c&&h!==c||!h&&c||h&&!c){e.preventDefault?e.preventDefault():e.returnValue=!1;return}}u=="p"&&(t.ie||(o=n.findParentByTagName(s.startContainer,["ol","ul","p","h1","h2","h3","h4","h5","h6","blockquote","caption"],!0),!o&&!t.opera?(i.document.execCommand("formatBlock",!1,"<p>"),t.gecko&&(s=i.selection.getRange(),o=n.findParentByTagName(s.startContainer,"p",!0),o&&n.removeDirtyAttr(o))):(r=o.tagName,o.tagName.toLowerCase()=="p"&&t.gecko&&n.removeDirtyAttr(o))))}})},UM.commands.preview={execCommand:function(){var t=window.open("","_blank",""),n=t.document;n.open(),n.write("<html><head></head><body><div>"+this.getContent(null,null,!0)+"</div></body></html>"),n.close()},notNeedUndo:1},UM.plugins.basestyle=function(){var i=["bold","underline","superscript","subscript","italic","strikethrough"],n=this;n.addshortcutkey({Bold:"ctrl+66",Italic:"ctrl+73",Underline:"ctrl+shift+85",strikeThrough:"ctrl+shift+83"}),n.addOutputRule(function(n){jQuery.each(n.getNodesByTagName("b i u strike s"),function(n,t){switch(t.tagName){case"b":t.tagName="strong";break;case"i":t.tagName="em";break;case"u":t.tagName="span",t.setStyle("text-decoration","underline");break;case"s":case"strike":t.tagName="span",t.setStyle("text-decoration","line-through")}})}),jQuery.each(i,function(i,r){n.commands[r]={execCommand:function(n){var i=this.selection.getRange(),t;return i.collapsed&&this.queryCommandState(n)!=1?(t=this.document.createElement(({bold:"strong",underline:"u",superscript:"sup",subscript:"sub",italic:"em",strikethrough:"strike"})[n]),i.insertNode(t).setStart(t,0).setCursor(!1),!0):this.document.execCommand(n)},queryCommandState:function(n){if(t.gecko)return this.document.queryCommandState(n);var r=this.selection.getStartElementPath(),i=!1;return jQuery.each(r,function(t,r){switch(n){case"bold":if(r.nodeName=="STRONG"||r.nodeName=="B")return i=1,!1;break;case"underline":if(r.nodeName=="U"||r.nodeName=="SPAN"&&jQuery(r).css("text-decoration")=="underline")return i=1,!1;break;case"superscript":if(r.nodeName=="SUP")return i=1,!1;break;case"subscript":if(r.nodeName=="SUB")return i=1,!1;break;case"italic":if(r.nodeName=="EM"||r.nodeName=="I")return i=1,!1;break;case"strikethrough":if(r.nodeName=="S"||r.nodeName=="STRIKE"||r.nodeName=="SPAN"&&jQuery(r).css("text-decoration")=="line-through")return i=1,!1}}),i}}})},UM.plugins.video=function(){function t(t,i,r,u,f,e){return e?'<embed type="application/x-shockwave-flash" class="edui-faked-video" pluginspage="http://www.macromedia.com/go/getflashplayer" src="'+t+'" width="'+i+'" height="'+r+'"'+(f?' style="float:'+f+'"':"")+' wmode="transparent" play="true" loop="false" menu="false" allowscriptaccess="never" allowfullscreen="true" >':"<img "+(u?'id="'+u+'"':"")+' width="'+i+'" height="'+r+'" _url="'+t+'" class="edui-faked-video" src="'+n.options.UMEDITOR_HOME_URL+'themes/default/images/spacer.gif" style="background:url('+n.options.UMEDITOR_HOME_URL+"themes/default/images/videologo.gif) no-repeat center center; border:1px solid gray;"+(f?"float:"+f+";":"")+'" />'}function r(n,r){i.each(n.getNodesByTagName(r?"img":"embed"),function(n){if(n.getAttr("class")=="edui-faked-video"){var i=t(r?n.getAttr("_url"):n.getAttr("src"),n.getAttr("width"),n.getAttr("height"),null,n.getStyle("float")||"",r);n.parentNode.replaceChild(UM.uNode.createElement(i),n)}})}var n=this,u;n.addOutputRule(function(n){r(n,!0)}),n.addInputRule(function(n){r(n)}),n.commands.insertvideo={execCommand:function(r,u){var o,h,f,e,s;for(u=i.isArray(u)?u:[u],o=[],h="tmpVedio",f=0,s=u.length;f<s;f++)e=u[f],o.push(t(e.url,e.width||420,e.height||280,h+f,e.align,!1));n.execCommand("inserthtml",o.join(""),!0)},queryCommandState:function(){var t=n.selection.getRange().getClosedNode(),i=t&&t.className=="edui-faked-video";return i?1:0}}},UM.plugins.selectall=function(){var i=this;i.commands.selectall={execCommand:function(){var u=this,i=u.body,r=u.selection.getRange();r.selectNodeContents(i),n.isEmptyBlock(i)&&(t.opera&&i.firstChild&&i.firstChild.nodeType==1&&r.setStartAtFirst(i.firstChild),r.collapse(!0)),r.select(!0)},notNeedUndo:1},i.addshortcutkey({selectAll:"ctrl+65"})},UM.plugins.removeformat=function(){var n=this;n.commands.removeformat={execCommand:function(){this.document.execCommand("removeformat")}}},UM.plugins.keystrokes=function(){var i=this,r=!0;i.addListener("keydown",function(u,f){var h=f.keyCode||f.which,e=i.selection.getRange(),s,o,v,l,a,y,c;if(!e.collapsed&&!(f.ctrlKey||f.shiftKey||f.altKey||f.metaKey)&&(h>=65&&h<=90||h>=48&&h<=57||h>=96&&h<=111||({13:1,8:1,46:1})[h])){s=e.startContainer,n.isFillChar(s)&&e.setStartBefore(s),s=e.endContainer,n.isFillChar(s)&&e.setEndAfter(s),e.txtToElmBoundary(),e.endContainer&&e.endContainer.nodeType==1&&(s=e.endContainer.childNodes[e.endOffset],s&&n.isBr(s)&&e.setEndAfter(s));if(e.startOffset==0){s=e.startContainer;if(n.isBoundaryNode(s,"firstChild")){s=e.endContainer;if(e.endOffset==(s.nodeType==3?s.nodeValue.length:s.childNodes.length)&&n.isBoundaryNode(s,"lastChild")){i.fireEvent("saveScene"),i.body.innerHTML="<p>"+(t.ie?"":"<br/>")+"</p>",e.setStart(i.body.firstChild,0).setCursor(!1,!0),i._selectionChange();return}}}}if(h==8){e=i.selection.getRange(),r=e.collapsed;if(i.fireEvent("delkeydown",f))return;e.collapsed&&e.inFillChar()&&(o=e.startContainer,n.isFillChar(o)?(e.setStartBefore(o).shrinkBoundary(!0).collapse(!0),n.remove(o)):(o.nodeValue=o.nodeValue.replace(new RegExp("^"+n.fillChar),""),e.startOffset--,e.collapse(!0).select(!0)));if(o=e.getClosedNode()){i.fireEvent("saveScene"),e.setStartBefore(o),n.remove(o),e.setCursor(),i.fireEvent("saveScene"),n.preventDefault(f);return}if(!t.ie){o=n.findParentByTagName(e.startContainer,"table",!0),v=n.findParentByTagName(e.endContainer,"table",!0);if(o&&!v||!o&&v||o!==v){f.preventDefault();return}}o=e.startContainer,e.collapsed&&o.nodeType==1&&(l=o.childNodes[e.startOffset-1],l&&l.nodeType==1&&l.tagName=="BR"&&(i.fireEvent("saveScene"),e.setStartBefore(l).collapse(!0),n.remove(l),e.select(),i.fireEvent("saveScene")));if(t.chrome)if(e.collapsed){while(e.startOffset==0&&!n.isEmptyBlock(e.startContainer))e.setStartBefore(e.startContainer);a=e.startContainer.childNodes[e.startOffset-1],a&&a.nodeName=="BR"&&(e.setStartBefore(a),i.fireEvent("saveScene"),jQuery(a).remove(),e.setCursor(),i.fireEvent("saveScene"))}}if(t.gecko&&h==46){y=i.selection.getRange();if(y.collapsed){o=y.startContainer;if(n.isEmptyBlock(o)){c=o.parentNode;while(n.getChildCount(c)==1&&!n.isBody(c))o=c,c=c.parentNode;o===c.lastChild&&f.preventDefault();return}}}}),i.addListener("keyup",function(i,u){var a=u.keyCode||u.which,f,c=this,l,s,o,e,h;if(a==8){if(c.fireEvent("delkeyup"))return;f=c.selection.getRange();if(f.collapsed){l=["h1","h2","h3","h4","h5","h6"];if(e=n.findParentByTagName(f.startContainer,l,!0))if(n.isEmptyBlock(e)){s=e.previousSibling;if(s&&s.nodeName!="TABLE"){n.remove(e),f.setStartAtLast(s).setCursor(!1,!0);return}o=e.nextSibling;if(o&&o.nodeName!="TABLE"){n.remove(e),f.setStartAtFirst(o).setCursor(!1,!0);return}}n.isBody(f.startContainer)&&(e=n.createElement(c.document,"p",{innerHTML:t.ie?n.fillChar:"<br/>"}),f.insertNode(e).setStart(e,0).setCursor(!1,!0))}!r&&(f.startContainer.nodeType==3||f.startContainer.nodeType==1&&n.isEmptyBlock(f.startContainer))&&(t.ie?(h=f.document.createElement("span"),f.insertNode(h).setStartBefore(h).collapse(!0),f.select(),n.remove(h)):f.select())}})},UM.plugins.dropfile=function(){var n=this;n.setOpt("dropFileEnabled",!0),n.getOpt("dropFileEnabled")&&window.FormData&&window.FileReader&&n.addListener("ready",function(){n.$body.on("drop",function(t){try{var r=t.originalEvent.dataTransfer.files,i=!1;r&&(jQuery.each(r,function(t,r){var u,f;/^image/.test(r.type)?(u=new XMLHttpRequest,u.open("post",n.getOpt("imageUrl"),!0),u.setRequestHeader("X-Requested-With","XMLHttpRequest"),f=new FormData,f.append(n.getOpt("imageFieldName")||"upfile",r),f.append("type","ajax"),u.send(f),u.addEventListener("load",function(t){var i=t.target.response;i&&n.execCommand("insertimage",{src:i,_src:i})}),i=!0):(u=new XMLHttpRequest,u.open("post",n.getOpt("imageUrl"),!0),u.setRequestHeader("X-Requested-With","XMLHttpRequest"),f=new FormData,f.append(n.getOpt("imageFieldName")||"upfile",r),f.append("type","attach"),u.send(f),u.addEventListener("load",function(t){var i,r;try{i=eval("("+t.target.response+")"),i.aid>0&&(r='<p><span class="attach-item"><img src="'+i.img+'" _src="'+i.img+'"><a href="'+i.url+'" _href="'+i.url+'" title="'+i.filename+'" target="_blank">'+i.filename+"</a></span></p>",n.execCommand("insertHtml",r,!0))}catch(t){}}),i=!0)}),i&&t.preventDefault())}catch(t){}}).on("dragover",function(n){n.originalEvent.dataTransfer.types[0]=="Files"&&n.preventDefault()})})},(function(n){function e(n,t,r){n.prototype=jQuery.extend2(jQuery.extend({},t),(UM.ui[r]||i).prototype,!0),n.prototype.supper=(UM.ui[r]||i).prototype;if(UM.ui[r]&&UM.ui[r].prototype.defaultOpt){var f=UM.ui[r].prototype.defaultOpt,u=n.prototype.defaultOpt;n.prototype.defaultOpt=jQuery.extend({},f,u||{})}return n}function f(i,r){n[t+r]=i,jQuery.fn[t+r]=function(n){var t,r=Array.prototype.slice.call(arguments,1);return this.each(function(u,f){var o=jQuery(f),e=o.edui();e||(i(!n||!jQuery.isPlainObject(n)?{}:n,o),o.edui(e));if(jQuery.type(n)=="string")if(n=="this")t=e;else{t=e[n].apply(e,r);if(t!==e&&t!==undefined)return!1;t=null}}),t!==null?t:this}}var r;jQuery.parseTmpl=function(n,t){var r="var __p=[],print=function(){__p.push.apply(__p,arguments);};with(obj||{}){__p.push('"+n.replace(/\\/g,"\\\\").replace(/'/g,"\\'").replace(/<%=([\s\S]+?)%>/g,function(n,t){return"',"+t.replace(/\\'/g,"'")+",'"}).replace(/<%([\s\S]+?)%>/g,function(n,t){return"');"+t.replace(/\\'/g,"'").replace(/[\r\n\t]/g," ")+"__p.push('"}).replace(/\r/g,"\\r").replace(/\n/g,"\\n").replace(/\t/g,"\\t")+"');}return __p.join('');",i=new Function("obj",r);return t?i(t):i},jQuery.extend2=function(n){for(var i=arguments,e=jQuery.type(i[i.length-1])=="boolean"?i[i.length-1]:!1,o=jQuery.type(i[i.length-1])=="boolean"?i.length-1:i.length,f,u,r=1;r<o;r++){f=i[r];for(u in f)(!e||!n.hasOwnProperty(u))&&(n[u]=f[u])}return n},jQuery.IE6=!!window.ActiveXObject&&parseFloat(navigator.userAgent.match(/msie (\d+)/i)[1])==6;var u=[],i=function(){},t="edui";i.prototype={on:function(n,t){this.root().on(n,jQuery.proxy(t,this));return this},off:function(n,t){return this.root().off(n,jQuery.proxy(t,this)),this},trigger:function(n,t){return this.root().trigger(n,t)===!1?!1:this},root:function(n){return this._$el||(this._$el=n)},destroy:function(){},data:function(n,i){return i!==undefined?(this.root().data(t+n,i),this):this.root().data(t+n)},register:function(n,t,i){u.push({evtname:n,$els:jQuery.isArray(t)?t:[t],handler:jQuery.proxy(i,t)})}},jQuery.fn.edui=function(n){return n?this.data("eduiwidget",n):this.data("eduiwidget")},r=1,UM.ui={define:function(n,i,u){var o=UM.ui[n]=e(function(i,u){var e=function(){},f;jQuery.extend(e.prototype,o.prototype,{guid:n+r++,widgetName:n}),f=new e;if(jQuery.type(i)=="string")return f.init&&f.init({}),f.root().edui(f),f.root().find("a").click(function(n){n.preventDefault()}),f.root()[t+n].apply(f.root(),arguments);u&&f.root(u),f.init&&f.init(!i||jQuery.isPlainObject(i)?jQuery.extend2(i||{},f.defaultOpt||{},!0):i);try{f.root().find("a").click(function(n){n.preventDefault()})}catch(s){}return f.root().edui(f)},i,u);f(o,n)}},jQuery(function(){jQuery(document).on("click mouseup mousedown dblclick mouseover",function(n){jQuery.each(u,function(t,i){i.evtname==n.type&&jQuery.each(i.$els,function(t,r){r[0]!==n.target&&!jQuery.contains(r[0],n.target)&&i.handler(n)})})})})})(jQuery),UM.ui.define("button",{tpl:'<<%if(!texttype){%>div class="edui-btn edui-btn-<%=icon%> <%if(name){%>edui-btn-name-<%=name%><%}%>" unselectable="on" onmousedown="return false" <%}else{%>a class="edui-text-btn"<%}%><% if(title) {%> data-original-title="<%=title%>" <%};%> <%if(icon==\'image\'){%> style="overflow:hidden"<%}%>> <%if(icon==\'image\'){%><form class="edui-image-form" method="post" enctype="multipart/form-data" target="up" style="margin:0"><input class="edui-image-upfile" multiple="multiple" type="file" name="upfile[]" tabindex="-1" accept="image/gif,image/jpeg,image/png,image/jpg,image/bmp" style="position: absolute; right: 0px; top: 0px; font-family: Arial; font-size: 118px; margin: 0px; padding: 0px; cursor: pointer; opacity: 0;filter:Alpha(opacity=0)width:30px;height:30px; "></form><iframe name="up" style="display: none"></iframe><%}%><% if(icon) {%><div unselectable="on" class="edui-icon-<%=icon%> edui-icon"></div><% }; %><%if(text) {%><span unselectable="on" onmousedown="return false" class="edui-button-label"><%=text%></span><%}%><%if(caret && text){%><span class="edui-button-spacing"></span><%}%><% if(caret) {%><span unselectable="on" onmousedown="return false" class="edui-caret"></span><% };%></<%if(!texttype){%>div<%}else{%>a<%}%>>',defaultOpt:{text:"",title:"",icon:"",width:"",caret:!1,texttype:!1,click:function(){}},init:function(n){var t=this;return t.root(jQuery(jQuery.parseTmpl(t.tpl,n))).click(function(i){t.wrapclick(n.click,i)}),t.root().hover(function(){t.root().hasClass("disabled")||t.root().toggleClass("hover")}),t},wrapclick:function(n,t){return this.disabled()||(this.root().trigger("wrapclick"),jQuery.proxy(n,this,t)()),this},label:function(n){return n===undefined?this.root().find(".edui-button-label").text():(this.root().find(".edui-button-label").text(n),this)},disabled:function(n){return n===undefined?this.root().hasClass("disabled"):(this.root().toggleClass("disabled",n),this.root().hasClass("disabled")&&this.root().removeClass("hover"),this)},active:function(n){return n===undefined?this.root().hasClass("active"):(this.root().toggleClass("active",n),this)},mergeWith:function(n){var t=this;t.data("$mergeObj",n),n.edui().data("$mergeObj",t.root()),jQuery.contains(document.body,n[0])||n.appendTo(t.root()),t.on("click",function(){t.wrapclick(function(){n.edui().show()})}).register("click",t.root(),function(){n.hide()})}}),(function(){UM.ui.define("toolbar",{tpl:'<div class="edui-toolbar"  ><div class="edui-btn-toolbar" unselectable="on" onmousedown="return false"  ></div></div>',init:function(){var n=this.root(jQuery(this.tpl));this.data("$btnToolbar",n.find(".edui-btn-toolbar"))},appendToBtnmenu:function(n){var t=this.data("$btnToolbar");n=jQuery.isArray(n)?n:[n],jQuery.each(n,function(n,i){t.append(i)})}})})(),UM.ui.define("menu",{show:function(n,t,i,r,u){i=i||"position";if(this.trigger("beforeshow")===!1)return;this.root().css(jQuery.extend({display:"block"},n?{top:n[i]().top+(t=="right"?0:n.outerHeight())-(r||0),left:n[i]().left+(t=="right"?n.outerWidth():0)-(u||0)}:{})),this.trigger("aftershow")},hide:function(n){var t;if(this.trigger("beforehide")===!1)return;(t=this.root().data("parentmenu"))&&(t.data("parentmenu")||n)&&t.edui().hide(),this.root().css("display","none"),this.trigger("afterhide")},attachTo:function(n){var t=this;if(!n.data("$mergeObj")){n.data("$mergeObj",t.root());n.on("wrapclick",function(){t.show()});t.register("click",n,function(){t.hide()}),t.data("$mergeObj",n)}}}),UM.ui.define("dropmenu",{tmpl:'<ul class="edui-dropdown-menu" aria-labelledby="dropdownMenu" ><%for(var i=0,ci;ci=data[i++];){%><%if(ci.divider){%><li class="edui-divider"></li><%}else{%><li <%if(ci.active||ci.disabled){%>class="<%= ci.active|| \'\' %> <%=ci.disabled||\'\' %>" <%}%> data-value="<%= ci.value%>"><a href="#" tabindex="-1"><em class="edui-dropmenu-checkbox"><i class="edui-icon-ok"></i></em><%= ci.label%></a></li><%}%><%}%></ul>',defaultOpt:{data:[],click:function(){}},init:function(n){var t=this,i={click:1,mouseover:1,mouseout:1};this.root(jQuery(jQuery.parseTmpl(this.tmpl,n))).on("click",'li[class!="disabled divider dropdown-submenu"]',function(i){jQuery.proxy(n.click,t,i,jQuery(this).data("value"),jQuery(this))()}).find("li").each(function(r,u){var e=jQuery(this),f;e.hasClass("disabled divider dropdown-submenu")||(f=n.data[r],jQuery.each(i,function(n){f[n]&&e[n](function(i){jQuery.proxy(f[n],u)(i,f,t.root)})}))})},disabled:function(n){jQuery("li[class!=divider]",this.root()).each(function(){var t=jQuery(this);n===!0?t.addClass("disabled"):jQuery.isFunction(n)?t.toggleClass("disabled",n(li)):t.removeClass("disabled")})},val:function(n){var t;return jQuery('li[class!="divider disabled dropdown-submenu"]',this.root()).each(function(){var i=jQuery(this);if(n===undefined){if(i.find("em.edui-dropmenu-checked").length)return t=i.data("value"),!1}else i.find("em").toggleClass("edui-dropmenu-checked",i.data("value")==n)}),n===undefined?t:void 0},addSubmenu:function(n,t,i){i=i||0;var r=jQuery("li[class!=divider]",this.root()),u=jQuery('<li class="dropdown-submenu"><a tabindex="-1" href="#">'+n+"</a></li>").append(t);i>=0&&i<r.length?u.insertBefore(r[i]):i<0?u.insertBefore(r[0]):i>=r.length&&u.appendTo(r)}},"menu"),UM.ui.define("splitbutton",{tpl:'<div class="edui-splitbutton <%if (name){%>edui-splitbutton-<%= name %><%}%>"  unselectable="on" <%if(title){%>data-original-title="<%=title%>"<%}%>><div class="edui-btn"  unselectable="on" ><%if(icon){%><div  unselectable="on" class="edui-icon-<%=icon%> edui-icon"></div><%}%><%if(text){%><%=text%><%}%></div><div  unselectable="on" class="edui-btn edui-dropdown-toggle" ><div  unselectable="on" class="edui-caret"></div></div></div>',defaultOpt:{text:"",title:"",click:function(){}},init:function(n){var t=this;return t.root(jQuery(jQuery.parseTmpl(t.tpl,n))),t.root().find(".edui-btn:first").click(function(){t.disabled()||jQuery.proxy(n.click,t)()}),t.root().find(".edui-dropdown-toggle").click(function(){t.disabled()||t.trigger("arrowclick")}),t.root().hover(function(){t.root().hasClass("disabled")||t.root().toggleClass("hover")}),t},wrapclick:function(n,t){return this.disabled()||jQuery.proxy(n,this,t)(),this},disabled:function(n){return n===undefined?this.root().hasClass("disabled"):(this.root().toggleClass("disabled",n).find(".edui-btn").toggleClass("disabled",n),this)},active:function(n){return n===undefined?this.root().hasClass("active"):(this.root().toggleClass("active",n).find(".edui-btn:first").toggleClass("active",n),this)},mergeWith:function(n){var t=this;t.data("$mergeObj",n),n.edui().data("$mergeObj",t.root()),jQuery.contains(document.body,n[0])||n.appendTo(t.root()),t.root().delegate(".edui-dropdown-toggle","click",function(){t.wrapclick(function(){n.edui().show()})}),t.register("click",t.root().find(".edui-dropdown-toggle"),function(){n.hide()})}}),UM.ui.define("colorsplitbutton",{tpl:'<div class="edui-splitbutton <%if (name){%>edui-splitbutton-<%= name %><%}%>"  unselectable="on" <%if(title){%>data-original-title="<%=title%>"<%}%>><div class="edui-btn"  unselectable="on" ><%if(icon){%><div  unselectable="on" class="edui-icon-<%=icon%> edui-icon"></div><%}%><div class="edui-splitbutton-color-label" <%if (color) {%>style="background: <%=color%>"<%}%>></div><%if(text){%><%=text%><%}%></div><div  unselectable="on" class="edui-btn edui-dropdown-toggle" ><div  unselectable="on" class="edui-caret"></div></div></div>',defaultOpt:{color:""},init:function(n){var t=this;t.supper.init.call(t,n)},colorLabel:function(){return this.root().find(".edui-splitbutton-color-label")}},"splitbutton"),UM.ui.define("popup",{tpl:'<div class="edui-dropdown-menu edui-popup"<%if(!<%=stopprop%>){%>onmousedown="return false"<%}%>><div class="edui-popup-body" unselectable="on" onmousedown="return false"><%=subtpl%></div><div class="edui-popup-caret"></div></div>',defaultOpt:{stopprop:!1,subtpl:"",width:"",height:""},init:function(n){return this.root(jQuery(jQuery.parseTmpl(this.tpl,n))),this},mergeTpl:function(n){return jQuery.parseTmpl(this.tpl,{subtpl:n})},show:function(n,t){var r,u,i;t||(t={}),r=t.fnname||"position";if(this.trigger("beforeshow")===!1)return;u=n[r]().left+(t.dir=="right"?n.outerWidth():0)-(t.offsetLeft||0),i=u+this.root().width()-n.parent().width(),i<0&&(i=0),this.root().css(jQuery.extend({display:"block"},n?{top:n[r]().top+(t.dir=="right"?0:n.outerHeight())-(t.offsetTop||0),left:n[r]().left+(t.dir=="right"?n.outerWidth():0)-(t.offsetLeft||0)-i,position:"absolute"}:{})),this.root().find(".edui-popup-caret").css({top:t.caretTop||0,left:t.caretLeft+i||0,position:"absolute"}).addClass(t.caretDir||"up"),this.trigger("aftershow")},hide:function(){this.root().css("display","none"),this.trigger("afterhide")},attachTo:function(n,t){var i=this;if(!n.data("$mergeObj")){n.data("$mergeObj",i.root());n.on("wrapclick",function(){i.show(n,t)});i.register("click",n,function(){i.hide()}),i.data("$mergeObj",n)}},getBodyContainer:function(){return this.root().find(".edui-popup-body")}}),UM.ui.define("scale",{tpl:'<div class="edui-scale" unselectable="on"><span class="edui-scale-hand0"></span><span class="edui-scale-hand1"></span><span class="edui-scale-hand2"></span><span class="edui-scale-hand3"></span><span class="edui-scale-hand4"></span><span class="edui-scale-hand5"></span><span class="edui-scale-hand6"></span><span class="edui-scale-hand7"></span></div>',defaultOpt:{$doc:jQuery(document),$wrap:jQuery(document)},init:function(n){return n.$doc&&(this.defaultOpt.$doc=n.$doc),n.$wrap&&(this.defaultOpt.$wrap=n.$wrap),this.root(jQuery(jQuery.parseTmpl(this.tpl,n))),this.initStyle(),this.startPos=this.prePos={x:0,y:0},this.dragId=-1,this},initStyle:function(){i.cssRule("scale",".edui-scale{display:none;position:absolute;border:1px solid #38B2CE;cursor:hand;}.edui-scale span{position:absolute;left:0;top:0;width:7px;height:7px;overflow:hidden;font-size:0px;display:block;background-color:#3C9DD0;}.edui-scale .edui-scale-hand0{cursor:nw-resize;top:0;margin-top:-4px;left:0;margin-left:-4px;}.edui-scale .edui-scale-hand1{cursor:n-resize;top:0;margin-top:-4px;left:50%;margin-left:-4px;}.edui-scale .edui-scale-hand2{cursor:ne-resize;top:0;margin-top:-4px;left:100%;margin-left:-3px;}.edui-scale .edui-scale-hand3{cursor:w-resize;top:50%;margin-top:-4px;left:0;margin-left:-4px;}.edui-scale .edui-scale-hand4{cursor:e-resize;top:50%;margin-top:-4px;left:100%;margin-left:-3px;}.edui-scale .edui-scale-hand5{cursor:sw-resize;top:100%;margin-top:-3px;left:0;margin-left:-4px;}.edui-scale .edui-scale-hand6{cursor:s-resize;top:100%;margin-top:-3px;left:50%;margin-left:-4px;}.edui-scale .edui-scale-hand7{cursor:se-resize;top:100%;margin-top:-3px;left:100%;margin-left:-3px;}")},_eventHandler:function(n){var t=this,u=t.defaultOpt.$doc,i,r;switch(n.type){case"mousedown":i=n.target||n.srcElement,i.className.indexOf("edui-scale-hand")!=-1&&(t.dragId=i.className.slice(-1),t.startPos.x=t.prePos.x=n.clientX,t.startPos.y=t.prePos.y=n.clientY,u.bind("mousemove",jQuery.proxy(t._eventHandler,t)));break;case"mousemove":t.dragId!=-1&&(t.updateContainerStyle(t.dragId,{x:n.clientX-t.prePos.x,y:n.clientY-t.prePos.y}),t.prePos.x=n.clientX,t.prePos.y=n.clientY,t.updateTargetElement());break;case"mouseup":t.dragId!=-1&&(t.dragId=-1,t.updateTargetElement(),r=t.data("$scaleTarget"),r.parent()&&t.attachTo(t.data("$scaleTarget"))),u.unbind("mousemove",jQuery.proxy(t._eventHandler,t))}},updateTargetElement:function(){var n=this,i=n.root(),t=n.data("$scaleTarget");t.css({width:i.width(),height:i.height()}),n.attachTo(t)},updateContainerStyle:function(n,t){var f=this,i=f.root(),r,u=[[0,0,-1,-1],[0,0,0,-1],[0,0,1,-1],[0,0,-1,0],[0,0,1,0],[0,0,-1,1],[0,0,0,1],[0,0,1,1]];u[n][0]!=0&&(r=parseInt(i.offset().left)+t.x,i.css("left",f._validScaledProp("left",r))),u[n][1]!=0&&(r=parseInt(i.offset().top)+t.y,i.css("top",f._validScaledProp("top",r))),u[n][2]!=0&&(r=i.width()+u[n][2]*t.x,i.css("width",f._validScaledProp("width",r))),u[n][3]!=0&&(r=i.height()+u[n][3]*t.y,i.css("height",f._validScaledProp("height",r)))},_validScaledProp:function(n,t){var u=this.root(),r=this.defaultOpt.$doc,i=function(n,i,r){return n+i>r?r-i:t};t=isNaN(t)?0:t;switch(n){case"left":return t<0?0:i(t,u.width(),r.width());case"top":return t<0?0:i(t,u.height(),r.height());case"width":return t<=0?1:i(t,u.offset().left,r.width());case"height":return t<=0?1:i(t,u.offset().top,r.height())}},show:function(n){var t=this;n&&t.attachTo(n),t.root().bind("mousedown",jQuery.proxy(t._eventHandler,t)),t.defaultOpt.$doc.bind("mouseup",jQuery.proxy(t._eventHandler,t)),t.root().show(),t.trigger("aftershow")},hide:function(){var n=this;n.root().unbind("mousedown",jQuery.proxy(n._eventHandler,n)),n.defaultOpt.$doc.unbind("mouseup",jQuery.proxy(n._eventHandler,n)),n.root().hide(),n.trigger("afterhide")},attachTo:function(n){var t=this,u=n.offset(),f=t.root(),i=t.defaultOpt.$wrap,r=i.offset();t.data("$scaleTarget",n),t.root().css({position:"absolute",width:n.width(),height:n.height(),left:u.left-r.left-parseInt(i.css("border-left-width"))-parseInt(f.css("border-left-width")),top:u.top-r.top-parseInt(i.css("border-top-width"))-parseInt(f.css("border-top-width"))})},getScaleTarget:function(){return this.data("$scaleTarget")[0]}}),UM.ui.define("colorpicker",{tpl:function(n){for(var i="ffffff,000000,eeece1,1f497d,4f81bd,c0504d,9bbb59,8064a2,4bacc6,f79646,f2f2f2,7f7f7f,ddd9c3,c6d9f0,dbe5f1,f2dcdb,ebf1dd,e5e0ec,dbeef3,fdeada,d8d8d8,595959,c4bd97,8db3e2,b8cce4,e5b9b7,d7e3bc,ccc1d9,b7dde8,fbd5b5,bfbfbf,3f3f3f,938953,548dd4,95b3d7,d99694,c3d69b,b2a2c7,92cddc,fac08f,a5a5a5,262626,494429,17365d,366092,953734,76923c,5f497a,31859b,e36c09,7f7f7f,0c0c0c,1d1b10,0f243e,244061,632423,4f6128,3f3151,205867,974806,c00000,ff0000,ffc000,ffff00,92d050,00b050,00b0f0,0070c0,002060,7030a0,".split(","),r='<div unselectable="on" onmousedown="return false" class="edui-colorpicker<%if (name){%> edui-colorpicker-<%=name%><%}%>" ><table unselectable="on" onmousedown="return false"><tr><td colspan="10">'+n.lang_themeColor+'</td> </tr><tr class="edui-colorpicker-firstrow" >',t=0;t<i.length;t++)t&&t%10==0&&(r+="</tr>"+(t==60?'<tr><td colspan="10">'+n.lang_standardColor+"</td></tr>":"")+"<tr"+(t==60?' class="edui-colorpicker-firstrow"':"")+">"),r+=t<70?'<td><a unselectable="on" onmousedown="return false" title="'+i[t]+'" class="edui-colorpicker-colorcell" data-color="#'+i[t]+'" style="background-color:#'+i[t]+";border:solid #ccc;"+(t<10||t>=60?"border-width:1px;":t>=10&&t<20?"border-width:1px 1px 0 1px;":"border-width:0 1px 0 1px;")+'"></a></td>':"";return r+="</tr></table></div>"},init:function(n){var t=this;t.root(jQuery(jQuery.parseTmpl(t.supper.mergeTpl(t.tpl(n)),n)));t.root().on("click",function(n){t.trigger("pickcolor",jQuery(n.target).data("color"))})}},"popup"),(function(){var i="combobox",n="edui-combobox-item",u="edui-combobox-item-hover",r="edui-combobox-checked-icon",t="edui-combobox-item-label";UM.ui.define(i,function(){return{tpl:'<ul class="dropdown-menu edui-combobox-menu<%if (comboboxName!==\'\') {%> edui-combobox-<%=comboboxName%><%}%>" unselectable="on" onmousedown="return false" role="menu" aria-labelledby="dropdownMenu"><%if(autoRecord) {%><%for( var i=0, len = recordStack.length; i<len; i++ ) {%><%var index = recordStack[i];%><li class="<%=itemClassName%><%if( selected == index ) {%> edui-combobox-checked<%}%>" data-item-index="<%=index%>" unselectable="on" onmousedown="return false"><span class="edui-combobox-icon" unselectable="on" onmousedown="return false"></span><label class="<%=labelClassName%>" style="<%=itemStyles[ index ]%>" unselectable="on" onmousedown="return false"><%=items[index]%></label></li><%}%><%if( i ) {%><li class="edui-combobox-item-separator"></li><%}%><%}%><%for( var i=0, label; label = items[i]; i++ ) {%><li class="<%=itemClassName%><%if( selected == i ) {%> edui-combobox-checked<%}%> edui-combobox-item-<%=i%>" data-item-index="<%=i%>" unselectable="on" onmousedown="return false"><span class="edui-combobox-icon" unselectable="on" onmousedown="return false"></span><label class="<%=labelClassName%>" style="<%=itemStyles[ i ]%>" unselectable="on" onmousedown="return false"><%=label%></label></li><%}%></ul>',defaultOpt:{recordStack:[],items:[],value:[],comboboxName:"",selected:"",autoRecord:!0,recordCount:5},init:function(i){var u=this;jQuery.extend(u._optionAdaptation(i),u._createItemMapping(i.recordStack,i.items),{itemClassName:n,iconClass:r,labelClassName:t}),this._transStack(i),u.root(jQuery(jQuery.parseTmpl(u.tpl,i))),this.data("options",i).initEvent()},initEvent:function(){var n=this;n.initSelectItem(),this.initItemActive()},initSelectItem:function(){var i=this,r="."+t;i.root().delegate("."+n,"click",function(){var t=jQuery(this),n=t.attr("data-item-index");return i.trigger("comboboxselect",{index:n,label:t.find(r).text(),value:i.data("options").value[n]}).select(n),i.hide(),!1})},initItemActive:function(){var t={mouseenter:"addClass",mouseleave:"removeClass"};if(jQuery.IE6)this.root().delegate("."+n,"mouseenter mouseleave",function(n){jQuery(this)[t[n.type]](u)}).one("afterhide",function(){})},select:function(n){var i=this.data("options").itemCount,t=this.data("options").autowidthitem;return t&&!t.length&&(t=this.data("options").items),i==0?null:(n<0?n=i+n%i:n>=i&&(n=i-1),this.trigger("changebefore",t[n]),this._update(n),this.trigger("changeafter",t[n]),null)},selectItemByLabel:function(n){var i=this.data("options").itemMapping,r=this,t=null;!jQuery.isArray(n)&&(n=[n]),jQuery.each(n,function(n,u){return t=i[u],t!==undefined?(r.select(t),!1):void 0})},_transStack:function(n){var i=[],t=-1,r=-1;jQuery.each(n.recordStack,function(u,f){t=n.itemMapping[f],jQuery.isNumeric(t)&&(i.push(t),f==n.selected&&(r=t))}),n.recordStack=i,n.selected=r,i=null},_optionAdaptation:function(n){if(!("itemStyles"in n)){n.itemStyles=[];for(var t=0,i=n.items.length;t<i;t++)n.itemStyles.push("")}return n.autowidthitem=n.autowidthitem||n.items,n.itemCount=n.items.length,n},_createItemMapping:function(n,t){var i={},r={recordStack:[],mapping:{}};return jQuery.each(t,function(n,t){i[t]=n}),r.itemMapping=i,jQuery.each(n,function(n,t){i[t]!==undefined&&(r.recordStack.push(i[t]),r.mapping[t]=i[t])}),r},_update:function(n){var i=this.data("options"),t=[],r=null;jQuery.each(i.recordStack,function(i,r){r!=n&&t.push(r)}),t.unshift(n),t.length>i.recordCount&&(t.length=i.recordCount),i.recordStack=t,i.selected=n,r=jQuery(jQuery.parseTmpl(this.tpl,i)),this.root().html(r.html()),r=null,t=null}}}(),"menu")})(),(function(){var n="buttoncombobox";UM.ui.define(n,function(){return{defaultOpt:{label:"",title:""},init:function(n){var t=this,i=jQuery.eduibutton({caret:!0,name:n.comboboxName,title:n.title,text:n.label,click:function(){t.show(this.root())}});t.supper.init.call(t,n);t.on("changebefore",function(n,t){i.eduibutton("label",t)});t.data("button",i),t.attachTo(i)},button:function(){return this.data("button")}}}(),"combobox")})(),UM.ui.define("modal",{tpl:'<div class="edui-modal" tabindex="-1" ><div class="edui-modal-header"><div class="edui-close" data-hide="modal"></div><h3 class="edui-title"><%=title%></h3></div><div class="edui-modal-body"  style="<%if(width){%>width:<%=width%>px;<%}%><%if(height){%>height:<%=height%>px;<%}%>"> </div><% if(cancellabel || oklabel) {%><div class="edui-modal-footer"><div class="edui-modal-tip"></div><%if(oklabel){%><div class="edui-btn edui-btn-primary" data-ok="modal"><%=oklabel%></div><%}%><%if(cancellabel){%><div class="edui-btn" data-hide="modal"><%=cancellabel%></div><%}%></div><%}%></div>',defaultOpt:{title:"",cancellabel:"",oklabel:"",width:"",height:"",backdrop:!0,keyboard:!0},init:function(n){var t=this;t.root(jQuery(jQuery.parseTmpl(t.tpl,n||{}))),t.data("options",n);if(n.okFn)t.on("ok",jQuery.proxy(n.okFn,t));if(n.cancelFn)t.on("beforehide",jQuery.proxy(n.cancelFn,t));t.root().delegate('[data-hide="modal"]',"click",jQuery.proxy(t.hide,t)).delegate('[data-ok="modal"]',"click",jQuery.proxy(t.ok,t)),jQuery('[data-hide="modal"],[data-ok="modal"]',t.root()).hover(function(){jQuery(this).toggleClass("hover")})},toggle:function(){var n=this;return n[n.data("isShown")?"hide":"show"]()},show:function(){var n=this;n.trigger("beforeshow");if(n.data("isShown"))return;n.data("isShown",!0),n.escape(),n.backdrop(function(){n.autoCenter(),n.root().show().focus().trigger("aftershow")})},showTip:function(n){jQuery(".edui-modal-tip",this.root()).html(n).fadeIn()},hideTip:function(){jQuery(".edui-modal-tip",this.root()).fadeOut(function(){jQuery(this).html("")})},autoCenter:function(){!jQuery.IE6&&this.root().css("margin-left",-(this.root().width()/2))},hide:function(){var n=this;n.trigger("beforehide");if(!n.data("isShown"))return;n.data("isShown",!1),n.escape(),n.hideModal()},escape:function(){var n=this;if(n.data("isShown")&&n.data("options").keyboard)n.root().on("keyup",function(t){t.which==27&&n.hide()});else n.data("isShown")||n.root().off("keyup")},hideModal:function(){var n=this;n.root().hide(),n.backdrop(function(){n.removeBackdrop(),n.trigger("afterhide")})},removeBackdrop:function(){this.$backdrop&&this.$backdrop.remove(),this.$backdrop=null},backdrop:function(n){var t=this;t.data("isShown")&&t.data("options").backdrop&&(t.$backdrop=jQuery('<div class="edui-modal-backdrop" />').click(t.data("options").backdrop=="static"?jQuery.proxy(t.root()[0].focus,t.root()[0]):jQuery.proxy(t.hide,t))),t.trigger("afterbackdrop"),n&&n()},attachTo:function(n){var t=this;if(!n.data("$mergeObj")){n.data("$mergeObj",t.root());n.on("click",function(){t.toggle(n)});t.data("$mergeObj",n)}},ok:function(){var n=this;n.trigger("beforeok");if(n.trigger("ok",n)===!1)return;n.hide()},getBodyContainer:function(){return this.root().find(".edui-modal-body")}}),UM.ui.define("tooltip",{tpl:'<div class="edui-tooltip" unselectable="on" onmousedown="return false"><div class="edui-tooltip-arrow" unselectable="on" onmousedown="return false"></div><div class="edui-tooltip-inner" unselectable="on" onmousedown="return false"></div></div>',init:function(n){var t=this;t.root(jQuery(jQuery.parseTmpl(t.tpl,n||{})))},content:function(n){var i=this,t=jQuery(n.currentTarget).attr("data-original-title");i.root().find(".edui-tooltip-inner").text(t)},position:function(n){var i=this,t=jQuery(n.currentTarget);i.root().css(jQuery.extend({display:"block"},t?{top:t.outerHeight(),left:(t.outerWidth()-i.root().outerWidth())/2}:{}))},show:function(n){if(jQuery(n.currentTarget).hasClass("disabled"))return;var t=this;t.content(n),t.root().appendTo(jQuery(n.currentTarget)),t.position(n),t.root().css("display","block").addClass("in bottom")},hide:function(){var n=this;n.root().removeClass("in bottom").css("display","none")},attachTo:function(n){function t(n){var t=this;jQuery.contains(document.body,t.root()[0])||t.root().appendTo(n),t.data("tooltip",t.root()),n.each(function(){if(jQuery(this).attr("data-original-title"))jQuery(this).on("mouseenter",jQuery.proxy(t.show,t)).on("mouseleave click",jQuery.proxy(t.hide,t))})}var i=this;jQuery.type(n)==="undefined"?jQuery("[data-original-title]").each(function(n,r){t.call(i,jQuery(r))}):n.data("tooltip")||t.call(i,n)}}),UM.ui.define("tab",{init:function(n){var t=this,i=n.selector;if(jQuery.type(i)){t.root(jQuery(i,n.context)),t.data("context",n.context);jQuery(i,t.data("context")).on("click",function(n){t.show(n)})}},show:function(n){var r=this,i=jQuery(n.target),o=i.closest("ul"),t,f,u,n,e;t=i.attr("href"),t=t&&t.replace(/.*(?=#[^\s]*$)/,""),e=i.parent("li");if(!e.length||e.hasClass("active"))return;f=o.find(".active:last a")[0],n=jQuery.Event("beforeshow",{target:i[0],relatedTarget:f}),r.trigger(n);if(n.isDefaultPrevented())return;u=jQuery(t,r.data("context")),r.activate(i.parent("li"),o),r.activate(u,u.parent(),function(){r.trigger({type:"aftershow",relatedTarget:f})})},activate:function(n,t,i){if(n===undefined)return jQuery(".edui-tab-item.active",this.root()).index();var r=t.find("> .active");r.removeClass("active"),n.addClass("active"),i&&i()}}),UM.ui.define("separator",{tpl:'<div class="edui-separator" unselectable="on" onmousedown="return false" ></div>',init:function(n){var t=this;return t.root(jQuery(jQuery.parseTmpl(t.tpl,n))),t}}),(function(){var e={},n={},o=[],s=null,u={},r={},f={};i.extend(UM,{defaultWidth:500,defaultHeight:500,registerUI:function(n,t){i.each(n.split(/\s+/),function(n){e[n]=t})},setEditor:function(t){!n[t.id]&&(n[t.id]=t)},registerWidget:function(n,t,i){u[n]=jQuery.extend2(t,{$root:"",_preventDefault:!1,root:function(n){return this.$root||(this.$root=n)},preventDefault:function(){this._preventDefault=!0},clear:!1}),i&&(r[n]=i)},getWidgetData:function(n){return u[n]},setWidgetBody:function(n,t,f){var e,o;f._widgetData||(f._widgetData={},f.getWidgetData=function(n){return this._widgetData[n]},f.getWidgetCallback=function(n){return r[n]}),e=u[n];if(!e)return null;e=f._widgetData[n],e||(e=u[n],e=f._widgetData[n]=jQuery.type(e)=="function"?e:i.clone(e)),e.root(t.edui().getBodyContainer()),e.initContent(f,t),e._preventDefault||e.initEvent(f,t),e.width&&t.width(e.width),o=r[n],o&&!o.init&&(r[n]=function(){var n=Array.prototype.slice.call(arguments,0);o.apply(f,[f,t].concat(n))},r[n].init=!0)},setActiveWidget:function(n){s=n},getEditor:function(t,i){return n[t]||(n[t]=this.createEditor(t,i))},clearCache:function(t){n[t]&&delete n[t]},delEditor:function(t){var i;(i=n[t])&&i.destroy()},ready:function(n){o.push(n)},createEditor:function(n,t){function r(){var r=this.createUI("#"+n,i),t;i.key=n,i.ready(function(){jQuery.each(o,function(n,t){jQuery.proxy(t,i)()})}),t=i.options,t.minFrameWidth=t.initialFrameWidth?t.initialFrameWidth:t.initialFrameWidth=i.$body.width()||UM.defaultWidth,r.css({width:t.initialFrameWidth,zIndex:i.getOpt("zIndex")}),UM.browser.ie&&UM.browser.version===6&&document.execCommand("BackgroundImageCache",!1,!0),i.render(n),jQuery.eduitooltip&&jQuery.eduitooltip("attachTo").css("z-index",i.getOpt("zIndex")+1),r.find("a").click(function(n){n.preventDefault()}),i.fireEvent("afteruiready")}var i=new UM.Editor(t),u=this;return i.langIsReady?jQuery.proxy(r,u)():i.addListener("langReady",jQuery.proxy(r,u)),i},createUI:function(n,i){var u=jQuery(n),r=jQuery('<div class="edui-container"><div class="edui-editor-body"></div></div>').insertBefore(u),o;return i.$container=r,i.container=r[0],i.$body=u,t.ie&&t.ie9above&&(o=jQuery('<span style="padding:0;margin:0;height:0;width:0"></span>'),o.insertAfter(r)),jQuery.each(e,function(n,t){var r=t.call(i,n);r&&(f[n]=r)}),r.find(".edui-editor-body").append(u).before(this.createToolbar(i.options,i)),r.find(".edui-toolbar").append(jQuery('<div class="edui-dialog-container"></div>')),r},createToolbar:function(n){var r=jQuery.eduitoolbar(),u=r.edui(),i;return n.toolbar&&n.toolbar.length?(i=[],jQuery.each(n.toolbar,function(n,t){jQuery.each(t.split(/\s+/),function(n,t){if(t=="|")jQuery.eduiseparator&&i.push(jQuery.eduiseparator());else{var r=f[t];t=="fullscreen"?r&&i.unshift(r):r&&i.push(r)}}),i.length&&u.appendToBtnmenu(i)})):r.find(".edui-btn-toolbar").remove(),r}})})(),UM.registerUI("bold italic redo undo underline strikethrough superscript subscript insertorderedlist insertunorderedlist cleardoc selectall link unlink print preview justifyleft justifycenter justifyright justifyfull removeformat horizontal attach image save save_new",function(n){var i=this,t=jQuery.eduibutton({icon:n,click:function(){i.execCommand(n)},title:this.getLang("labelMap")[n]||""});return this.addListener("selectionchange",function(){var i=this.queryCommandState(n);t.edui().disabled(i==-1).active(i==1)}),t}),(function(){function t(n){var t=this;if(!n)throw new Error("invalid params, notfound editor");t.editor=n,i[n.uid]=this,n.addListener("destroy",function(){delete i[n.uid],t.editor=null})}var u={},f=["width","height","position","top","left","margin","padding","overflowX","overflowY"],e={},o={},r={},i={};UM.registerUI("fullscreen",function(n){var i=this,r=jQuery.eduibutton({icon:"fullscreen",title:i.options.labelMap&&i.options.labelMap[n]||i.getLang("labelMap."+n),click:function(){i.execCommand(n)}});return i.addListener("selectionchange",function(){var t=this.queryCommandState(n);r.edui().disabled(t==-1).active(t==1)}),i.addListener("ready",function(){i.options.fullscreen&&t.getInstance(i).toggle()}),r}),UM.commands.fullscreen={execCommand:function(){t.getInstance(this).toggle()},queryCommandState:function(){return this._edui_fullscreen_status},notNeedUndo:1},t.prototype={toggle:function(){var t=this.editor,n=this.isFullState();t.fireEvent("beforefullscreenchange",!n),this.update(!n),n?this.revert():this.enlarge(),t.fireEvent("afterfullscreenchange",!n),t.body.contentEditable==="true"&&t.fireEvent("fullscreenchanged",!n),t.fireEvent("selectionchange")},enlarge:function(){this.saveSataus(),this.setDocumentStatus(),this.resize()},revert:function(){var t=this.editor.options,n=/%$/.test(t.initialFrameHeight)?"100%":t.initialFrameHeight-this.getStyleValue("padding-top")-this.getStyleValue("padding-bottom")-this.getStyleValue("border-width");jQuery.IE6&&this.getEditorHolder().style.setExpression("height","this.scrollHeight <= "+n+' ? "'+n+'px" : "auto"'),this.revertContainerStatus(),this.revertContentAreaStatus(),this.revertDocumentStatus()},update:function(n){this.editor._edui_fullscreen_status=n},resize:function(){var f=null,e=0,o=0,r=0,s=0,i=this.editor,h=this,u=null,t=null;if(!this.isFullState())return;f=jQuery(window),o=f.width(),e=f.height(),t=this.getEditorHolder(),r=parseInt(n.getComputedStyle(t,"border-width"),10)||0,r+=parseInt(n.getComputedStyle(i.container,"border-width"),10)||0,s+=parseInt(n.getComputedStyle(t,"padding-left"),10)+parseInt(n.getComputedStyle(t,"padding-right"),10)||0,jQuery.IE6&&t.style.setExpression("height",null),u=this.getBound(),jQuery(i.container).css({zIndex:1e4,width:o+"px",height:e+"px",position:jQuery.IE6?"absolute":"fixed",top:u.top,left:u.left,margin:0,padding:0,overflowX:"hidden",overflowY:"hidden"}),jQuery(t).css({width:o-2*r-s+"px",height:e-2*r-(i.options.withoutToolbar?0:jQuery(".edui-toolbar",i.container).outerHeight())-jQuery(".edui-bottombar",i.container).outerHeight()+"px",overflowX:"hidden",overflowY:"auto"})},saveSataus:function(){for(var e=this.editor.container.style,t=null,r={},n=0,i=f.length;n<i;n++)t=f[n],r[t]=e[t];u[this.editor.uid]=r,this.saveContentAreaStatus(),this.saveDocumentStatus()},saveContentAreaStatus:function(){var n=jQuery(this.getEditorHolder());e[this.editor.uid]={width:n.css("width"),overflowX:n.css("overflowX"),overflowY:n.css("overflowY"),height:n.css("height")}},saveDocumentStatus:function(){var n=jQuery(this.getEditorDocumentBody());o[this.editor.uid]={overflowX:n.css("overflowX"),overflowY:n.css("overflowY")},r[this.editor.uid]={overflowX:jQuery(this.getEditorDocumentElement()).css("overflowX"),overflowY:jQuery(this.getEditorDocumentElement()).css("overflowY")}},revertContainerStatus:function(){jQuery(this.editor.container).css(this.getEditorStatus()).css("z-index",this.editor.options.zIndex)},revertContentAreaStatus:function(){var t=this.getEditorHolder(),n=this.getContentAreaStatus();this.supportMin()&&(delete n.height,t.style.height=null),jQuery(t).css(n)},revertDocumentStatus:function(){var n=this.getDocumentStatus();jQuery(this.getEditorDocumentBody()).css("overflow","visible"),jQuery(this.getEditorDocumentElement()).css("overflow","auto")},setDocumentStatus:function(){jQuery(this.getEditorDocumentBody()).css({overflowX:"hidden",overflowY:"hidden"}),jQuery(this.getEditorDocumentElement()).css({overflowX:"hidden",overflowY:"hidden"})},isFullState:function(){return!!this.editor._edui_fullscreen_status},getEditorStatus:function(){return u[this.editor.uid]},getContentAreaStatus:function(){return e[this.editor.uid]},getEditorDocumentElement:function(){return this.editor.container.ownerDocument.documentElement},getEditorDocumentBody:function(){return this.editor.container.ownerDocument.body},getEditorHolder:function(){return this.editor.body},getDocumentStatus:function(){return{body:o[this.editor.uid],html:r[this.editor.uid]}},supportMin:function(){var n=null;return this._support||(n=document.createElement("div"),this._support="minWidth"in n.style,n=null),this._support},getBound:function(){var i={html:!0,body:!0},t={top:0,left:0},n=null;return jQuery.IE6?(n=this.editor.container.offsetParent,n&&!i[n.nodeName.toLowerCase()]&&(i=n.getBoundingClientRect(),t.top=-i.top,t.left=-i.left),t):t},getStyleValue:function(t){return parseInt(n.getComputedStyle(this.getEditorHolder(),t))}},jQuery.extend(t,{listen:function(){var n=null;if(t._hasFullscreenListener)return;t._hasFullscreenListener=!0;jQuery(window).on("resize",function(){n!==null&&(window.clearTimeout(n),n=null),n=window.setTimeout(function(){for(var t in i)i[t].resize();n=null},50)})},getInstance:function(n){return i[n.uid]||new t(n),i[n.uid]}}),t.listen()})(),UM.registerUI("link map insertvideo",function(n){var t=this,f,u,s={insertvideo:"video"},o=s[n]||n,r={title:t.options.labelMap&&t.options.labelMap[n]||t.getLang("labelMap."+n),url:t.options.UMEDITOR_HOME_URL+"dialogs/"+o+"/"+o+".js"},e=jQuery.eduibutton({icon:n,title:this.getLang("labelMap")[n]||""});return i.loadFile(document,{src:r.url,tag:"script",type:"text/javascript",defer:"defer"},function(){var i=UM.getWidgetData(n),s,o;i.buttons&&(s=i.buttons.ok,s&&(r.oklabel=s.label||t.getLang("ok"),s.exec&&(r.okFn=function(){return jQuery.proxy(s.exec,null,t,u)()})),o=i.buttons.cancel,o&&(r.cancellabel=o.label||t.getLang("cancel"),o.exec&&(r.cancelFn=function(){return jQuery.proxy(o.exec,null,t,u)()}))),i.width&&(r.width=i.width),i.height&&(r.height=i.height),u=jQuery.eduimodal(r),u.attr("id","edui-dialog-"+n).find(".edui-modal-body").addClass("edui-dialog-"+n+"-body"),u.edui().on("beforehide",function(){var n=t.selection.getRange();n.equals(f)&&n.select()}).on("beforeshow",function(){var i=this.root(),e=null,r=null;f=t.selection.getRange(),i.parent()[0]||t.$container.find(".edui-dialog-container").append(i),jQuery.IE6&&(e={width:jQuery(window).width(),height:jQuery(window).height()},r=i.parents(".edui-toolbar")[0].getBoundingClientRect(),i.css({position:"absolute",margin:0,left:(e.width-i.width())/2-r.left,top:100-r.top})),UM.setWidgetBody(n,u,t)}).on("afterbackdrop",function(){this.$backdrop.css("zIndex",t.getOpt("zIndex")+1).appendTo(t.$container.find(".edui-dialog-container")),u.css("zIndex",t.getOpt("zIndex")+2)}).on("beforeok",function(){try{f.select()}catch(n){}}).attachTo(e)}),t.addListener("selectionchange",function(){var t=this.queryCommandState(n);e.edui().disabled(t==-1).active(t==1)}),e}),UM.registerUI("emotion",function(n){var t=this,u=t.options.UMEDITOR_HOME_URL+"dialogs/"+n+"/"+n+".js",r=jQuery.eduibutton({icon:n,title:this.getLang("labelMap")[n]||""});return i.loadFile(document,{src:u,tag:"script",type:"text/javascript",defer:"defer"},function(){var f={url:u},i=UM.getWidgetData(n);i.width&&(f.width=i.width),i.height&&(f.height=i.height),jQuery.eduipopup(f).css("zIndex",t.options.zIndex+1).edui().on("beforeshow",function(){var i=this.root();i.parent().length||t.$container.find(".edui-dialog-container").append(i),UM.setWidgetBody(n,i,t)}).attachTo(r,{offsetTop:-5,offsetLeft:10,caretLeft:11,caretTop:-8}),t.addListener("selectionchange",function(){var n=this.queryCommandState("emotion");r.edui().disabled(n==-1).active(n==1)})}),r}),UM.registerUI("imagescale",function(){var n=this,i;n.setOpt("imageScaleEnabled",!0),t.webkit&&n.getOpt("imageScaleEnabled")&&(n.addListener("click",function(){var e=n.selection.getRange(),u=e.getClosedNode(),t,r,f;if(u&&u.tagName=="IMG"){if(!i){i=jQuery.eduiscale({$wrap:n.$container}).css("zIndex",n.options.zIndex),n.$container.append(i),t=function(){i.edui().hide()},r=function(n){var i=n.target||n.srcElement;i&&i.className.indexOf("edui-scale")==-1&&t(n)};i.edui().on("aftershow",function(){jQuery(document).bind("keydown",t),jQuery(document).bind("mousedown",r),n.selection.getNative().removeAllRanges()}).on("afterhide",function(){jQuery(document).unbind("keydown",t),jQuery(document).unbind("mousedown",r);var u=i.edui().getScaleTarget();u.parentNode&&n.selection.getRange().selectNode(u).select()}).on("mousedown",function(t){n.selection.getNative().removeAllRanges();var r=t.target||t.srcElement;r&&r.className.indexOf("edui-scale-hand")==-1&&(f=setTimeout(function(){i.edui().hide()},200))}).on("mouseup",function(n){var t=n.target||n.srcElement;t&&t.className.indexOf("edui-scale-hand")==-1&&clearTimeout(f)})}i.edui().show(jQuery(u))}else i&&i.css("display")!="none"&&i.edui().hide()}),n.addListener("click",function(t,i){if(i.target.tagName=="IMG"){var r=new u.Range(n.document,n.body);r.selectNode(i.target).select()}}))}),UM.registerUI("autofloat",function(){var r=this,e=r.getLang(),f,u;r.setOpt({topOffset:0}),f=r.options.autoFloatEnabled!==!1,u=r.options.topOffset;if(!f)return;r.ready(function(){function p(){return UM.ui?1:(alert(e.autofloatMsg),0)}function b(){var n=document.body.style;n.backgroundImage='url("about:blank")',n.backgroundAttachment="fixed"}function d(){if(h)return;var o=n.getXY(f),i=n.getComputedStyle(f,"position"),e=n.getComputedStyle(f,"left");f.style.width=f.offsetWidth+"px",f.style.zIndex=r.options.zIndex*1+1,f.parentNode.insertBefore(s,f),y||w&&t.ie?(f.style.position!="absolute"&&(f.style.position="absolute"),f.style.top=(document.body.scrollTop||document.documentElement.scrollTop)-c+u+"px"):f.style.position!="fixed"&&(f.style.position="fixed",f.style.top=u+"px",(i=="absolute"||i=="relative")&&parseFloat(e)&&(f.style.left=o.x+"px"))}function a(){s.parentNode&&s.parentNode.removeChild(s),f.style.cssText=v}function o(){var n=k(r.container),t=r.options.toolbarTopOffset||0;n.top<0&&n.bottom-f.offsetHeight>t?d():a()}var y=t.ie&&t.version<=6,w=t.quirks,v,s=document.createElement("div"),f,c,k=function(t){var i,r,u;try{i=t.getBoundingClientRect()}catch(f){i={left:0,top:0,height:0,width:0}}r={left:Math.round(i.left),top:Math.round(i.top),height:Math.round(i.bottom-i.top),width:Math.round(i.right-i.left)};while((u=t.ownerDocument)!==document&&(t=n.getWindow(u).frameElement))i=t.getBoundingClientRect(),r.left+=i.left,r.top+=i.top;return r.bottom=r.top+r.height,r.right=r.left+r.width,r},h=!1,l=i.defer(function(){o()},t.ie?200:100,!0);r.addListener("destroy",function(){n.un(window,["scroll","resize"],o),r.removeListener("keydown",l)});if(p(r)){f=jQuery(".edui-toolbar",r.container)[0],r.addListener("afteruiready",function(){setTimeout(function(){c=jQuery(f).offset().top},100)}),v=f.style.cssText,s.style.height=f.offsetHeight+"px",y&&b();n.on(window,["scroll","resize"],o);jQuery(".bs-main-container,body").scroll(function(){r.container&&o()}),r.addListener("keydown",l),r.addListener("beforefullscreenchange",function(n,t){t&&(a(),h=t)}),r.addListener("fullscreenchanged",function(n,t){t||o(),h=t}),r.addListener("sourcemodechanged",function(){setTimeout(function(){o()},0)}),r.addListener("clearDoc",function(){setTimeout(function(){o()},0)})}})}),UM.registerUI("source",function(n){var t=this,i;return t.addListener("fullscreenchanged",function(){t.$container.find("textarea").width(t.$body.width()-10).height(t.$body.height())}),i=jQuery.eduibutton({icon:n,click:function(){t.execCommand(n)},title:this.getLang("labelMap")[n]||""}),this.addListener("selectionchange",function(){var t=this.queryCommandState(n);i.edui().disabled(t==-1).active(t==1)}),i}),UM.registerUI("paragraph fontfamily fontsize",function(n){function f(n,t){var i=jQuery("<span>").html(n).css({display:"inline",position:"absolute",top:-1e7,left:-1e5}).appendTo(document.body),r=i.width();return i.remove(),i=null,r<50?n:(n=n.slice(0,t?-4:-1),n.length?f(n+"...",!0):"...")}function h(n){var i=[],t;for(t in n.items)n.value.push(t),i.push(t),n.autowidthitem.push(f(t));return n.items=i,n.autoRecord=!1,n}function s(n){for(var i=null,r=[],t=0,u=n.items.length;t<u;t++)i=n.items[t].val,r.push(i.split(/\s*,\s*/)[0]),n.itemStyles.push("font-family: "+i),n.value.push(i),n.autowidthitem.push(f(r[t]));return n.items=r,n}function o(n){var i=null,u=[],t,r;for(n.itemStyles=[],n.value=[],t=0,r=n.items.length;t<r;t++)i=n.items[t],u.push(i),n.itemStyles.push("font-size: "+i+"px");return n.value=n.items,n.items=u,n.autoRecord=!1,n}var i=this,e=i.options.labelMap&&i.options.labelMap[n]||i.getLang("labelMap."+n),t={label:e,title:e,comboboxName:n,items:i.options[n]||[],itemStyles:[],value:[],autowidthitem:[]},u=null,r=null;switch(n){case"paragraph":t=h(t);break;case"fontfamily":t=s(t);break;case"fontsize":t=o(t)}u=jQuery.eduibuttoncombobox(t).css("zIndex",i.getOpt("zIndex")+1),r=u.edui();r.on("comboboxselect",function(t,r){i.execCommand(n,r.value)}).on("beforeshow",function(){u.parent().length===0&&u.appendTo(i.$container.find(".edui-dialog-container"))});return this.addListener("selectionchange",function(){var u=this.queryCommandState(n),i=this.queryCommandValue(n);r.button().edui().disabled(u==-1).active(u==1),i&&(i=i.replace(/['"]/g,"").toLowerCase().split(/['|"]?\s*,\s*[\1]?/),r.selectItemByLabel(i))}),r.button().addClass("edui-combobox")}),UM.registerUI("forecolor backcolor",function(t){function e(){return n.getComputedStyle(f[0],"background-color")}var i=this,u=null,f=null,r=null;return this.addListener("selectionchange",function(){var n=this.queryCommandState(t);r.edui().disabled(n==-1).active(n==1)}),r=jQuery.eduicolorsplitbutton({icon:t,caret:!0,name:t,title:i.getLang("labelMap")[t],click:function(){i.execCommand(t,e())}}),f=r.edui().colorLabel(),u=jQuery.eduicolorpicker({name:t,lang_clearColor:i.getLang("clearColor")||"",lang_themeColor:i.getLang("themeColor")||"",lang_standardColor:i.getLang("standardColor")||""}).on("pickcolor",function(n,r){window.setTimeout(function(){f.css("backgroundColor",r),i.execCommand(t,r)},0)}).on("show",function(){UM.setActiveWidget(colorPickerWidget.root())}).css("zIndex",i.getOpt("zIndex")+1),r.edui().on("arrowclick",function(){u.parent().length||i.$container.find(".edui-dialog-container").append(u),u.edui().show(r,{caretDir:"down",offsetTop:-5,offsetLeft:8,caretLeft:11,caretTop:-8})}).register("click",r,function(){u.edui().hide()}),r})})()